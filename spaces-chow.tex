\input{preamble}

% OK, start here.
%
\begin{document}

\title{Chow Groups of Spaces}

\maketitle

\phantomsection
\label{section-phantom}


\tableofcontents


\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we first discuss Chow groups of algebraic spaces.
Having defined these, we define chern classes of vector bundles as
operators on these chow groups. The strategy will be entirely
the same as the strategy in the case of schemes. Therefore we
urge the reader to take a look at the introduction
(Chow Homology, Section \ref{chow-section-introduction})
of the corresponding chapter for schemes.

\medskip\noindent
Some related papers: \cite{edidin-graham} and \cite{kresch_cycle}.



\section{Setup}
\label{section-setup}

\noindent
We first fix the category of algebraic spaces we will be working with.
Please keep in mind throughout this chapter that
``decent $+$ locally Noetherian'' is the same as
``quasi-separated $+$ locally Noetherian'' according to
Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.

\begin{situation}
\label{situation-setup}
Here $S$ is a scheme and $B$ is an algebraic space over $S$.
We assume $B$ is quasi-separated, locally Noetherian, and
universally catenary (Decent Spaces, Definition
\ref{decent-spaces-definition-universally-catenary}).
Moreover, we assume given a dimension function
$\delta : |B| \longrightarrow \mathbf{Z}$.
We say $X/B$ is {\it good} if $X$ is an algebraic space
over $B$ whose structure morphism $f : X \to B$ is
quasi-separated and locally of finite type.
In this case we define
$$
\delta = \delta_{X/B} : |X| \longrightarrow \mathbf{Z}
$$
as the map sending $x$ to $\delta(f(x))$ plus the transcendence degree
of $x/f(x)$ (Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-dimension-fibre}).
This is a dimension function by
More on Morphisms of Spaces, Lemma
\ref{spaces-more-morphisms-lemma-universally-catenary-dimension-function}.
\end{situation}

\noindent
A special case is when $S = B$ is a scheme and $(S, \delta)$ is as in
Chow Homology, Situation \ref{chow-situation-setup}. Thus $B$ might be
the spectrum of a field (Chow Homology, Example \ref{chow-example-field})
or $B = \Spec(\mathbf{Z})$
(Chow Homology, Example \ref{chow-example-domain-dimension-1}).

\medskip\noindent
Many lemma, proposition, theorems, definitions on algebraic spaces
are easier in the setting of Situation \ref{situation-setup} because
the algebraic spaces we are working with are quasi-separated
(and thus a fortiori decent) and locally Noetherian. We will sprinkle
this chapter with remarks such as the following to point this out.

\begin{remark}
\label{remark-sober}
In Situation \ref{situation-setup} if $X/B$ is good, then
$|X|$ is a sober topological space. See
Properties of Spaces, Lemma \ref{spaces-properties-lemma-quasi-separated-sober}
or Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}.
We will use this without further mention
to choose generic points of irreducible closed subsets of $|X|$.
\end{remark}

\begin{remark}
\label{remark-integral}
In Situation \ref{situation-setup} if $X/B$ is good, then
$X$ is integral (Spaces over Fields, Definition
\ref{spaces-over-fields-definition-integral-algebraic-space})
if and only if $X$ is reduced and $|X|$ is irreducible.
Moreover, for any point $\xi \in |X|$ there is a unique integral closed
subspace $Z \subset X$ such that $\xi$ is the generic point
of the closed subset $|Z| \subset |X|$, see
Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-decent-irreducible-closed}.
\end{remark}

\noindent
If $B$ is Jacobson and $\delta$ sends closed points to zero, then $\delta$
is the function sending a point to the dimension of its closure.

\begin{lemma}
\label{lemma-delta-is-dimension}
In Situation \ref{situation-setup} assume $B$ is Jacobson
and that $\delta(b) = 0$ for every closed point $b$ of $|B|$.
Let $X/B$ be good. If $Z \subset X$ is an integral closed subspace
with generic point $\xi \in |Z|$, then the following integers are the same:
\begin{enumerate}
\item $\delta(\xi) = \delta_{X/B}(\xi)$,
\item $\dim(|Z|)$,
\item $\text{codim}(\{z\}, |Z|)$ for $z \in |Z|$ closed,
\item the dimension of the local ring of $Z$ at $z$ for
$z \in |Z|$ closed, and
\item $\dim(\mathcal{O}_{Z, \overline{z}})$ for $z \in |Z|$ closed.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X$, $Z$, $\xi$ be as in the lemma.
Since $X$ is locally of finite type over $B$ we see that $X$ is Jacobson, see
Decent Spaces, Lemma
\ref{decent-spaces-lemma-Jacobson-universally-Jacobson}.
Hence $X_{\text{ft-pts}} \subset |X|$ is the set of closed points
by Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-Jacobson-ft-pts}.
Given a chain $T_0 \supset \ldots \supset T_e$
of irreducible closed subsets of $|Z|$ we have
$T_e \cap X_{\text{ft-pts}}$ nonempty by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-enough-finite-type-points}.
Thus we can always assume such a chain ends
with $T_e = \{z\}$ for some $z \in |Z|$ closed.
It follows that $\dim(Z) = \sup_z \text{codim}(\{z\}, |Z|)$
where $z$ runs over the closed points of $|Z|$.
We have $\text{codim}(\{z\}, Z) = \delta(\xi) - \delta(z)$
by Topology, Lemma \ref{topology-lemma-dimension-function-catenary}.
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-type-points-morphism}
the image of $z$ is a finite type point of $B$, i.e.,
a closed point of $|B|$. By
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-jacobson-finite-type-points}
the transcendence degree of $z/b$ is $0$.
We conclude that $\delta(z) = \delta(b) = 0$ by assumption.
Thus we obtain equality
$$
\dim(|Z|) = \text{codim}(\{z\}, Z) = \delta(\xi)
$$
for all $z \in |Z|$ closed. Finally, we have that
$\text{codim}(\{z\}, Z)$ is equal to the dimension of the
local ring of $Z$ at $z$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring}
which in turn is equal to
$\dim(\mathcal{O}_{Z, \overline{z}})$ by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-dimension-local-ring}.
\end{proof}

\noindent
In the situation of the lemma above the value of $\delta$
at the generic point of a closed irreducible subset
is the dimension of the irreducible closed subset.
This motivates the following definition.

\begin{definition}
\label{definition-delta-dimension}
In Situation \ref{situation-setup} for any good $X/B$
and any irreducible closed subset $T \subset |X|$ we define
$$
\dim_\delta(T) = \delta(\xi)
$$
where $\xi \in T$ is the generic point of $T$.
We will call this the {\it $\delta$-dimension of $T$}.
If $T \subset |X|$ is any closed subset, then we define
$\dim_\delta(T)$ as the supremum of the $\delta$-dimensions
of the irreducible components of $T$.
If $Z$ is a closed subspace of $X$, then we set
$\dim_\delta(Z) = \dim_\delta(|Z|)$.
\end{definition}

\noindent
Of course this just means that
$\dim_\delta(T) = \sup \{\delta(t) \mid t \in T\}$.







\section{Cycles}
\label{section-cycles}

\noindent
This is the analogue of Chow Homology, Section \ref{chow-section-cycles}

\medskip\noindent
Since we are not assuming our spaces are quasi-compact we have
to be a little careful when defining cycles. We have to allow
infinite sums because a rational function may have infinitely many
poles for example. In any case, if $X$ is quasi-compact then a
cycle is a finite sum as usual.

\begin{definition}
\label{definition-cycles}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $k \in \mathbf{Z}$.
\begin{enumerate}
\item A {\it cycle on $X$} is a formal sum
$$
\alpha = \sum n_Z [Z]
$$
where the sum is over integral closed subspaces $Z \subset X$,
each $n_Z \in \mathbf{Z}$, and
$\{|Z|; n_Z \not = 0\}$ is a locally finite
collection of subsets of $|X|$
(Topology, Definition \ref{topology-definition-locally-finite}).
\item A {\it $k$-cycle} on $X$ is
a cycle
$$
\alpha = \sum n_Z [Z]
$$
where $n_Z \not = 0 \Rightarrow \dim_\delta(Z) = k$.
\item The abelian group of all $k$-cycles on $X$ is denoted $Z_k(X)$.
\end{enumerate}
\end{definition}

\noindent
In other words, a $k$-cycle on $X$ is a locally finite formal
$\mathbf{Z}$-linear combination of integral closed subspaces
(Remark \ref{remark-integral}) of $\delta$-dimension $k$.
Addition of $k$-cycles $\alpha = \sum n_Z[Z]$ and
$\beta = \sum m_Z[Z]$ is given by
$$
\alpha + \beta = \sum (n_Z + m_Z)[Z],
$$
i.e., by adding the coefficients.




\section{Multiplicities}
\label{section-multiplicities}

\noindent
A section with a few simple results on lengths and multiplicities.

\begin{lemma}
\label{lemma-length}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
The following are equivalent
\begin{enumerate}
\item
$\text{length}_{\mathcal{O}_{X, \overline{x}}} \mathcal{F}_{\overline{x}} = d$
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\end{enumerate}
\end{lemma}

\begin{proof}
Let $U \to X$ and $u \in U$ be as in (2) or (3). Then we know that
$\mathcal{O}_{X, \overline{x}}$ is the strict henselization of
$\mathcal{O}_{U, u}$ and that
$$
\mathcal{F}_{\overline{x}} =
(\mathcal{F}|_U)_u \otimes_{\mathcal{O}_{U, u}} \mathcal{O}_{X, \overline{x}}
$$
See Properties of Spaces,
Lemmas \ref{spaces-properties-lemma-describe-etale-local-ring} and
\ref{spaces-properties-lemma-stalk-quasi-coherent}.
Thus the equality of the lengths follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}
the fact that $\mathcal{O}_{U, u} \to \mathcal{O}_{X, \overline{x}}$
is flat and the fact that
$\mathcal{O}_{X, \overline{x}}/\mathfrak m_u\mathcal{O}_{X, \overline{x}}$
is equal to the residue field of $\mathcal{O}_{X, \overline{x}}$.
These facts about strict henselizations can be found in
More on Algebra, Lemma \ref{more-algebra-lemma-dumb-properties-henselization}.
\end{proof}

\begin{definition}
\label{definition-length-at-x}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
We say {\it $\mathcal{F}$ has length $d$ at $x$}
if the equivalent conditions of Lemma \ref{lemma-length}
are satisfied.
\end{definition}

\begin{lemma}
\label{lemma-length-closed-immersion}
Let $S$ be a scheme. Let $i : Y \to X$ be a closed immersion of
algebraic spaces over $S$. Let $\mathcal{G}$ be a quasi-coherent
$\mathcal{O}_Y$-module. Let $y \in |Y|$ with image $x \in |X|$.
Let $d \in \{0, 1, 2, \ldots, \infty\}$. The following are
equivalent
\begin{enumerate}
\item $\mathcal{G}$ has length $d$ at $y$, and
\item $i_*\mathcal{G}$ has length $d$ at $x$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose an \'etale morphism $f : U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$. Set $V = Y \times_X U$.
Denote $g : V \to Y$ and $j : V \to U$ the projections.
Then $j : V \to U$ is a closed immersion and there is a unique
point $v \in V$ mapping to $y \in |Y|$ and $u \in U$
(use Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and Spaces, Lemma \ref{spaces-lemma-base-change-immersions}).
We have $j_*(\mathcal{G}|_V) = (i_*\mathcal{G})|_U$ as modules
on the scheme $V$ and $j_*$ the ``usual'' pushforward of modules
for the morphism of schemes $j$, see discussion surrounding
Cohomology of Spaces, Equation
(\ref{spaces-cohomology-equation-representable-higher-direct-image}).
In this way we reduce to the case of schemes: if $i : Y \to X$
is a closed immersion of schemes, then
$$
(i_*\mathcal{G})_x = \mathcal{G}_y
$$
as modules over $\mathcal{O}_{X, x}$ where the module structure
on the right hand side is given by the surjection
$i_y^\sharp : \mathcal{O}_{X, x} \to \mathcal{O}_{Y, y}$.
Thus equality by
Algebra, Lemma \ref{algebra-lemma-length-independent}.
\end{proof}

\begin{lemma}
\label{lemma-length-finite}
Let $S$ be a scheme and let $X$ be a
locally Noetherian algebraic space over $S$.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. The following are equivalent
\begin{enumerate}
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item the length of $\mathcal{F}$ at $x$ is finite and nonzero.
\end{enumerate}
If $X$ is decent (equivalently quasi-separated) then these are
also equivalent to
\begin{enumerate}
\item[(4)] $x$ is a generic point of an irreducible component of
$\text{Supp}(\mathcal{F})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $f : U \to X$ is an \'etale morphism with $U$ a scheme
and $u \in U$ maps to $x$. Then $\mathcal{F}|_U = f^*\mathcal{F}$
is a coherent $\mathcal{O}_U$-module on the locally Noetherian
scheme $U$ and in particular $(\mathcal{F}|_U)_u$ is a finite
$\mathcal{O}_{U, u}$-module, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-Noetherian}
and Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}.
Recall that the support of $\mathcal{F}|_U$ is a closed subset of $U$
(Morphisms, Lemma \ref{morphisms-lemma-support-finite-type}) and
that the support of $(\mathcal{F}|_U)_u$ is the pullback
of the support of $\mathcal{F}|_U$ by the morphism
$\Spec(\mathcal{O}_{U, u}) \to U$. Thus $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$
if and only if the support of $(\mathcal{F}|_U)_u$ is equal
to the maximal ideal of $\mathcal{O}_{U, u}$.
Now the equivalence of (1), (2), (3) follows from
by Algebra, Lemma \ref{algebra-lemma-support-point}.

\medskip\noindent
If $X$ is decent we choose an \'etale morphism $f : U \to X$ and a point
$u \in U$ mapping to $x$. The support of $\mathcal{F}$ pulls back to
the support of $\mathcal{F}|_U$, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-support-finite-type}.
Also, specializations $x' \leadsto x$ in $|X|$ lift to specializations
$u' \leadsto u$ in $U$ and any nontrivial specialization $u' \leadsto u$ in $U$
maps to a nontrivial specialization $f(u') \leadsto f(u)$ in $|X|$, see
Decent Spaces, Lemmas
\ref{decent-spaces-lemma-decent-specialization} and
\ref{decent-spaces-lemma-decent-no-specializations-map-to-same-point}.
Using that $|X|$ and $U$ are sober topological spaces
(Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}
and
Schemes, Lemma \ref{schemes-lemma-scheme-sober}) we conclude
$x$ is a generic point of the support of $\mathcal{F}$
if and only if $u$ is a generic point of the support of
$\mathcal{F}|_U$. We conclude (4) is equivalent to (1).

\medskip\noindent
The parenthetical statement follows from Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.
\end{proof}

\begin{lemma}
\label{lemma-point-of-max-dimension}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $T \subset |X|$ be a closed subset and $t \in T$.
If $\dim_\delta(T) \leq k$ and $\delta(t) = k$, then
$t$ is a generic point of an irreducible component of $T$.
\end{lemma}

\begin{proof}
We know $t$ is contained in an irreducible component $T' \subset T$.
Let $t' \in T'$ be the generic point. Then
$k \geq \delta(t') \geq \delta(t)$. Since $\delta$ is a dimension
function we see that $t = t'$.
\end{proof}



\section{Cycle associated to a closed subspace}
\label{section-cycle-of-closed-subscheme}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-closed-subscheme}.

\begin{remark}
\label{remark-irreducible-component}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace. By
Remarks \ref{remark-sober} and \ref{remark-integral}
there are $1$-to-$1$ correspondences between
\begin{enumerate}
\item irreducible components $T$ of $|Y|$,
\item generic points of irreducible components of $|Y|$, and
\item integral closed subspaces $Z \subset Y$ with the property that
$|Z|$ is an irreducible component of $|Y|$.
\end{enumerate}
In this chapter we will call $Z$ as in (3) an
{\it irreducible component of $Y$}
and we will call $\xi \in |Z|$ its {\it generic point}.
\end{remark}

\begin{definition}
\label{definition-cycle-associated-to-closed-subscheme}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
\begin{enumerate}
\item For an irreducible component $Z \subset Y$ with generic point $\xi$
the length of $\mathcal{O}_Y$ at $\xi$
(Definition \ref{definition-length-at-x}) is called the
{\it multiplicity of $Z$ in $Y$}.
By Lemma \ref{lemma-length-finite} applied to $\mathcal{O}_Y$
on $Y$ this is a positive integer.
\item Assume $\dim_\delta(Y) \leq k$.
The {\it $k$-cycle associated to $Y$} is
$$
[Y]_k = \sum m_{Z, Y}[Z]
$$
where the sum is over the irreducible components $Z$ of $Y$
of $\delta$-dimension $k$ and $m_{Z, Y}$ is the multiplicity
of $Z$ in $Y$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[Y]_k$ if the $\delta$-dimension
of $Y$ does not exceed $k$. In other words, by convention, if we write
$[Y]_k$ then this implies that $\dim_\delta(Y) \leq k$.







\section{Cycle associated to a coherent sheaf}
\label{section-cycle-of-coherent-sheaf}

\noindent
This is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-coherent-sheaf}.

\begin{definition}
\label{definition-cycle-associated-to-coherent-sheaf}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
\begin{enumerate}
\item For an integral closed subspace $Z \subset X$ with generic point $\xi$
such that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
the length of $\mathcal{F}$ at $\xi$ (Definition \ref{definition-length-at-x})
is called the {\it multiplicity of $Z$ in $\mathcal{F}$}.
By Lemma \ref{lemma-length-finite} this is a positive integer.
\item Assume $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
The {\it $k$-cycle associated to $\mathcal{F}$} is
$$
[\mathcal{F}]_k = \sum m_{Z, \mathcal{F}}[Z]
$$
where the sum is over the integral closed subspaces $Z \subset X$
corresponding to irreducible components of
$\text{Supp}(\mathcal{F})$ of $\delta$-dimension $k$
and $m_{Z, \mathcal{F}}$ is the multiplicity of $Z$ in $\mathcal{F}$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[\mathcal{F}]_k$
if $\mathcal{F}$ is coherent and the $\delta$-dimension
of $\text{Supp}(\mathcal{F})$ does not exceed $k$. In other words,
by convention, if we write $[\mathcal{F}]_k$ then this implies that
$\mathcal{F}$ is coherent on $X$ and
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.

\begin{lemma}
\label{lemma-reformulate-coeff-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module
with $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
Let $\xi \in |Z|$ be the generic point.
Then the coefficient of $Z$ in $[\mathcal{F}]_k$
is the length of $\mathcal{F}$ at $\xi$.
\end{lemma}

\begin{proof}
Observe that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
if and only if $\xi \in \text{Supp}(\mathcal{F})$, see
Lemma \ref{lemma-point-of-max-dimension}.
Moreover, the length of $\mathcal{F}$ at $\xi$ is zero if
$\xi \not \in \text{Supp}(\mathcal{F})$. Combining this
with Definition \ref{definition-cycle-associated-to-coherent-sheaf}
we conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-closed-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
If $\dim_\delta(Y) \leq k$, then $[Y]_k = [i_*\mathcal{O}_Y]_k$
where $i : Y \to X$ is the inclusion morphism.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
If $Z \not \subset Y$ the $Z$ has coefficient zero in both
$[Y]_k$ and $[i_*\mathcal{O}_Y]_k$. If $Z \subset Y$, then
the generic point of $Z$ may be viewed as a point $y \in |Y|$
whose image $x \in |X|$. Then the coefficient of $Z$ in
$[Y]_k$ is the length of $\mathcal{O}_Y$ at $y$ and the
coefficient of $Z$ in $[i_*\mathcal{O}_Y]_k$ is the length
of $i_*\mathcal{O}_Y$ at $x$. Thus the equality of the coefficients
follows from Lemma \ref{lemma-length-closed-immersion}.
\end{proof}

\begin{lemma}
\label{lemma-additivity-sheaf-cycle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $0 \to \mathcal{F} \to \mathcal{G} \to \mathcal{H} \to 0$
be a short exact sequence of coherent $\mathcal{O}_X$-modules.
Assume that the $\delta$-dimension of the supports
of $\mathcal{F}$, $\mathcal{G}$, and $\mathcal{H}$ are $\leq k$.
Then $[\mathcal{G}]_k = [\mathcal{F}]_k + [\mathcal{H}]_k$.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
It suffices to show that the coefficients of
$Z$ in $[\mathcal{G}]_k$, $[\mathcal{F}]_k$, and $[\mathcal{H}]_k$
satisfy the corresponding additivity. By
Lemma \ref{lemma-reformulate-coeff-coherent}
it suffices to show
$$
\text{the length of }\mathcal{G}\text{ at }x =
\text{the length of }\mathcal{F}\text{ at }x +
\text{the length of }\mathcal{H}\text{ at }x
$$
for any $x \in |X|$. Looking at Definition \ref{definition-length-at-x}
this follows immediately from additivity of lengths, see
Algebra, Lemma \ref{algebra-lemma-length-additive}.
\end{proof}





\section{Preparation for proper pushforward}
\label{section-preparation-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-pushforward}.

\begin{lemma}
\label{lemma-proper-image}
In Situation \ref{situation-setup} let $X,Y/B$ be good and let $f : X \to Y$
be a morphism over $B$. If $Z \subset X$ is an integral closed subspace, then
there exists a unique integral closed subspace $Z' \subset Y$ such that there
is a commutative diagram
$$
\xymatrix{
Z \ar[r] \ar[d] & X \ar[d]^f \\
Z' \ar[r] & Y
}
$$
with $Z \to Z'$ dominant. If $f$ is proper, then $Z \to Z'$ is proper
and surjective.
\end{lemma}

\begin{proof}
Let $\xi \in |Z|$ be the generic point. Let $Z' \subset Y$ be the integral
closed subspace whose generic point is $\xi' = f(\xi)$, see
Remark \ref{remark-integral}. Since $\xi \in |f^{-1}(Z')| = |f|^{-1}(|Z'|)$
by Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and since $Z$ is the reduced with $|Z| = \overline{\{\xi\}}$
we see that $Z \subset f^{-1}(Z')$ as closed subspaces of $X$ (see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-map-into-reduction}).
Thus we obtain our morphism $Z \to Z'$.
This morphism is dominant as the generic point of $Z$
maps to the generic point of $Z'$. Uniqueness of $Z'$ is clear.
If $f$ is proper, then $Z \to Y$ is proper as a composition
of proper morphisms (Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper} and
\ref{spaces-morphisms-lemma-closed-immersion-proper}).
Then we conclude that $Z \to Z'$ is proper by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-universally-closed-permanence}.
Surjectivity then follows as the image of a proper morphism is closed.
\end{proof}

\begin{remark}
\label{remark-residue-field}
In Situation \ref{situation-setup} let $X/B$ be good. Every $x \in |X|$
can be represented by a (unique) monomorphism $\Spec(k) \to X$ where
$k$ is a field, see
Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-points-monomorphism}.
Then $k$ is the {\it residue field of} $x$ and is denoted $\kappa(x)$.
Recall that $X$ has a dense open subscheme $U \subset X$
(Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}).
If $x \in U$, then $\kappa(x)$ agrees with the residue
field of $x$ on $U$ as a scheme. See Decent Spaces, Section
\ref{decent-spaces-section-residue-fields-henselian-local-rings}.
\end{remark}

\begin{remark}
\label{remark-function-field}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is integral.
In this case the {\it function field} $R(X)$ of $X$ is defined and
is equal to the residue field of $X$ at its generic point.
See Spaces over Fields, Definition
\ref{spaces-over-fields-definition-function-field}.
Combining this with Remark \ref{remark-integral}
we find that for any $x \in X$ the residue field
$\kappa(x)$ is the function field of the
unique integral closed subspace $Z \subset X$
whose generic point is $x$.
\end{remark}

\begin{lemma}
\label{lemma-equal-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good and let
$f : X \to Y$ be a morphism over $B$.
Assume $X$, $Y$ integral and $\dim_\delta(X) = \dim_\delta(Y)$.
Then either $f$ factors through a proper closed subspace
of $Y$, or $f$ is dominant and the extension of function fields
$R(X) / R(Y)$ is finite.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-proper-image} there is a unique integral closed
subspace $Z \subset Y$ such that $f$ factors through a dominant
morphism $X \to Z$. Then $Z = Y$ if and only if
$\dim_\delta(Z) = \dim_\delta(Y)$. On the other hand, by
our construction of dimension functions (see Situation \ref{situation-setup})
we have $\dim_\delta(X) = \dim_\delta(Z) + r$ where $r$ the
transcendence degree of the extension $R(X)/R(Z)$. Combining this with
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-degree}
the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is quasi-compact, and $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|X|$.
Then $\{\overline{|f|(T_i)}\}_{i \in I}$ is a locally finite
collection of closed subsets of $|Y|$.
\end{lemma}

\begin{proof}
Let $V \subset |Y|$ be a quasi-compact open subset.
Then $|f|^{-1}(V) \subset |X|$ is quasi-compact
by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-is-quasi-compact}.
Hence the set
$\{i \in I : T_i \cap |f|^{-1}(V) \not = \emptyset \}$
is finite by a simple topological argument which we omit.
Since this is the same as the set
$$
\{i \in I : |f|(T_i) \cap V \not = \emptyset \} =
\{i \in I : \overline{|f|(T_i)} \cap V \not = \emptyset \}
$$
the lemma is proved.
\end{proof}










\section{Proper pushforward}
\label{section-proper-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-proper-pushforward}.

\begin{definition}
\label{definition-proper-pushforward}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is proper.
\begin{enumerate}
\item Let $Z \subset X$ be an integral closed subspace
with $\dim_\delta(Z) = k$. Let $Z' \subset Y$ be the
image of $Z$ as in Lemma \ref{lemma-proper-image}.
We define
$$
f_*[Z] =
\left\{
\begin{matrix}
0 & \text{if} & \dim_\delta(Z')< k, \\
\deg(Z/Z') [Z'] & \text{if} & \dim_\delta(Z') = k.
\end{matrix}
\right.
$$
The degree of $Z$ over $Z'$ is defined and finite if
$\dim_\delta(Z') = \dim_\delta(Z)$ by Lemma \ref{lemma-equal-dimension} and
Spaces over Fields, Definition \ref{spaces-over-fields-definition-degree}.
\item Let $\alpha = \sum n_Z [Z]$ be a $k$-cycle on $X$. The
{\it pushforward} of $\alpha$ as the sum
$$
f_* \alpha = \sum n_Z f_*[Z]
$$
where each $f_*[Z]$ is defined as above. The sum is locally finite
by Lemma \ref{lemma-quasi-compact-locally-finite} above.
\end{enumerate}
\end{definition}

\noindent
By definition the proper pushforward of cycles
$$
f_* : Z_k(X) \longrightarrow Z_k(Y)
$$
is a homomorphism of abelian groups. It turns $X \mapsto Z_k(X)$
into a covariant functor on the category whose object are good
algebraic spaces over $B$ and whose morphisms are proper morphisms
over $B$.

\begin{lemma}
\label{lemma-compose-pushforward}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be proper morphisms over $B$.
Then $g_* \circ f_* = (g \circ f)_*$ as maps $Z_k(X) \to Z_k(Z)$.
\end{lemma}

\begin{proof}
Let $W \subset X$ be an integral closed subspace of dimension $k$.
Consider the integral closed subspaces
$W' \subset Y$ and $W'' \subset Z$
we get by applying Lemma \ref{lemma-proper-image}
to $f$ and $W$ and then to $g$ and $W'$.
Then $W \to W'$ and $W' \to W''$ are surjective and proper.
We have to show that $g_*(f_*[W]) = (f \circ g)_*[W]$.
If $\dim_\delta(W'') < k$, then both sides are zero.
If $\dim_\delta(W'') = k$, then we see $W \to W'$ and $W' \to W''$
both satisfy the hypotheses of Lemma \ref{lemma-equal-dimension}.
Hence
$$
g_*(f_*[W]) = \deg(W/W')\deg(W'/W'')[W''],
\quad
(f \circ g)_*[W] = \deg(W/W'')[W''].
$$
Then we can apply
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-degree-composition}
to conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-push-sheaf}
In Situation \ref{situation-setup} let $f : X \to Y$ be a proper morphism
of good algebraic spaces over $B$.
\begin{enumerate}
\item Let $Z \subset X$ be a closed subspace with $\dim_\delta(Z) \leq k$.
Then
$$
f_*[Z]_k = [f_*{\mathcal O}_Z]_k.
$$
\item Let $\mathcal{F}$ be a coherent sheaf on $X$ such that
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. Then
$$
f_*[\mathcal{F}]_k = [f_*{\mathcal F}]_k.
$$
\end{enumerate}
Note that the statement makes sense since $f_*\mathcal{F}$ and
$f_*\mathcal{O}_Z$ are coherent $\mathcal{O}_Y$-modules by
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-proper-pushforward-coherent}.
\end{lemma}

\begin{proof}
Part (1) follows from (2) and Lemma \ref{lemma-cycle-closed-coherent}.
Let $\mathcal{F}$ be a coherent sheaf on $X$.
Assume that $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
By Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-support-closed}
there exists a closed immersion $i : Z \to X$ and a coherent
$\mathcal{O}_Z$-module $\mathcal{G}$ such that
$i_*\mathcal{G} \cong \mathcal{F}$ and such that the support
of $\mathcal{F}$ is $Z$. Let $Z' \subset Y$ be the scheme theoretic image
of $f|_Z : Z \to Y$, see Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-scheme-theoretic-image}.
Consider the commutative diagram
$$
\xymatrix{
Z \ar[r]_i \ar[d]_{f|_Z} &
X \ar[d]^f \\
Z' \ar[r]^{i'} & Y
}
$$
of algebraic spaces over $B$. Observe that $f|_Z$ is surjective
(follows from Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-scheme-theoretic-image}
and the fact that $|f|$ is closed) and proper
(follows from Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper},
\ref{spaces-morphisms-lemma-closed-immersion-proper}, and
\ref{spaces-morphisms-lemma-universally-closed-permanence}).
We have $f_*\mathcal{F} = f_*i_*\mathcal{G} = i'_*(f|_Z)_*\mathcal{G}$
by going around the diagram in two ways. Suppose we know the result holds
for closed immersions and for $f|_Z$. Then we see that
$$
f_*[\mathcal{F}]_k = f_*i_*[\mathcal{G}]_k
= (i')_*(f|_Z)_*[\mathcal{G}]_k =
(i')_*[(f|_Z)_*\mathcal{G}]_k =
[(i')_*(f|_Z)_*\mathcal{G}]_k = [f_*\mathcal{F}]_k
$$
as desired. The case of a closed immersion follows from
Lemma \ref{lemma-length-closed-immersion} and the definitions.
Thus we have reduced to the case where
$\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.

\medskip\noindent
Assume $\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.
For every irreducible component $Z \subset Y$
with generic point $\eta$ there exists a point $\xi \in X$ such
that $f(\xi) = \eta$. Hence $\delta(\eta) \leq \delta(\xi) \leq k$.
Thus we see that in the expressions
$$
f_*[\mathcal{F}]_k = \sum n_Z[Z],
\quad
\text{and}
\quad
[f_*\mathcal{F}]_k = \sum m_Z[Z].
$$
whenever $n_Z \not = 0$, or $m_Z \not = 0$ the integral closed
subspace $Z$ is actually an irreducible component of $Y$ of
$\delta$-dimension $k$ (see Lemma \ref{lemma-point-of-max-dimension}).
Pick such an integral closed subspace $Z \subset Y$ and denote $\eta$
its generic point.
Note that for any $\xi \in X$ with $f(\xi) = \eta$ we have $\delta(\xi) \geq k$
and hence $\xi$ is a generic point of an irreducible component
of $X$ of $\delta$-dimension $k$ as well
(see Lemma \ref{lemma-point-of-max-dimension}).
By Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-in-codim-1}
there exists an open subspace $\eta \in V \subset Y$
such that $f^{-1}(V) \to V$ is finite.
Since $\eta$ is a generic point of an irreducible component of
$|Y|$ we may assume $V$ is an affine scheme, see
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Replacing $Y$ by $V$ and $X$ by $f^{-1}(V)$ we reduce to the
case where $Y$ is affine, and $f$ is finite.
In particular $X$ and $Y$ are schemes and we reduce to
the corresponding result for schemes, see
Chow Homology, Lemma \ref{chow-lemma-cycle-push-sheaf}
(applied with $S = Y$).
\end{proof}













\section{Preparation for flat pullback}
\label{section-preparation-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-flat-pullback}.

\medskip\noindent
Recall that a morphism of algebraic spaces is said to have
relative dimension $r$ if \'etale locally on the source
and the target we get a morphism of schemes which has relative dimension $d$.
The precise definition is equivalent, but in fact slightly different, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-relative-dimension}.

\begin{lemma}
\label{lemma-flat-inverse-image-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
For any closed subset $T \subset |Y|$ we have
$$
\dim_\delta(|f|^{-1}(T)) = \dim_\delta(T) + r.
$$
provided $|f|^{-1}(T)$ is nonempty.
If $Z \subset Y$ is an integral closed subscheme and
$Z' \subset f^{-1}(Z)$ is an irreducible component, then
$Z'$ dominates $Z$ and $\dim_\delta(Z') = \dim_\delta(Z) + r$.
\end{lemma}

\begin{proof}
Since the $\delta$-dimension of a closed subset is the supremum of
the $\delta$-dimensions of the irreducible components, it suffices
to prove the final statement. We may replace $Y$ by the
integral closed subscheme $Z$ and $X$ by $f^{-1}(Z) = Z \times_Y X$.
Hence we may assume $Z = Y$ is integral and $f$ is a flat morphism
of relative dimension $r$. Since $Y$ is locally Noetherian the
morphism $f$ which is locally of finite type,
is actually locally of finite presentation. Hence
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-fppf-open}
applies and we see that $f$ is open.
Let $\xi \in X$ be a generic point of an irreducible component
of $X$. By the openness of $f$ we see that $f(\xi)$ is the
generic point $\eta$ of $Z = Y$. Thus $Z'$ dominates $Z = Y$.
Finally, we see  that $\xi$ and $\eta$ are in the schematic
locus of $X$ and $Y$ by
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Since $\xi$ is a generic point of $X$ we see that
$\mathcal{O}_{X, \xi} = \mathcal{O}_{X_\eta, \xi}$ has only one
prime ideal and hence has dimension $0$ (we may use usual
local rings as $\xi$ and $\eta$ are in the schematic loci
of $X$ and $Y$). Thus by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point}
(and the definition of morphisms of given relative dimension)
we conclude that the transcendence
degree of $\kappa(\xi)$ over $\kappa(\eta)$ is $r$.
In other words, $\delta(\xi) = \delta(\eta) + r$ as desired.
\end{proof}

\noindent
Here is the lemma that we will use to prove that the flat pullback
of a locally finite collection of closed subschemes is locally finite.

\begin{lemma}
\label{lemma-inverse-image-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|Y|$.
Then $\{|f|^{-1}(T_i)\}_{i \in I}$ is a locally finite
collection of closed subsets of $X$.
\end{lemma}

\begin{proof}
Let $U \subset |X|$ be a quasi-compact open subset.
Since the image $|f|(U) \subset |Y|$ is a quasi-compact subset
there exists a quasi-compact open $V \subset |Y|$ such that
$|f|(U) \subset V$. Note that
$$
\{i \in I : |f|^{-1}(T_i) \cap U \not = \emptyset \}
\subset
\{i \in I : T_i \cap V \not = \emptyset \}.
$$
Since the right hand side is finite by assumption we win.
\end{proof}

















\section{Flat pullback}
\label{section-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
Let $S$ be a scheme and let $f : X \to Y$ be a morphism of algebraic
spaces over $S$. Let $Z \subset Y$ be a closed subspace.
In this chapter we will sometimes use the terminology
{\it scheme theoretic inverse image} for the inverse image
$f^{-1}(Z)$ of $Z$ constructed in Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-inverse-image-closed-subspace}.
The scheme theoretic inverse image is the fibre product
$$
\xymatrix{
f^{-1}(Z) \ar[r] \ar[d] & X \ar[d] \\
Z \ar[r] & Y
}
$$
If $\mathcal{I} \subset \mathcal{O}_Y$ is the quasi-coherent sheaf of ideals
corresponding to $Z$ in $Y$, then $f^{-1}(\mathcal{I})\mathcal{O}_X$ is the
quasi-coherent sheaf of ideals corresponding to $f^{-1}(Z)$ in $X$.

\begin{definition}
\label{definition-flat-pullback}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be an integral closed subspace of
$\delta$-dimension $k$. We define $f^*[Z]$ to be the
$(k+r)$-cycle on $X$ associated to the scheme theoretic inverse image
$$
f^*[Z] = [f^{-1}(Z)]_{k+r}.
$$
This makes sense since $\dim_\delta(f^{-1}(Z)) = k + r$
by Lemma \ref{lemma-flat-inverse-image-dimension}.
\item Let $\alpha = \sum n_i [Z_i]$ be
a $k$-cycle on $Y$. The {\it flat pullback of $\alpha$ by $f$}
is the sum
$$
f^* \alpha = \sum n_i f^*[Z_i]
$$
where each $f^*[Z_i]$ is defined as above.
The sum is locally finite by Lemma \ref{lemma-inverse-image-locally-finite}.
\item We denote $f^* : Z_k(Y) \to Z_{k + r}(X)$ the map of abelian
groups so obtained.
\end{enumerate}
\end{definition}

\noindent
An open immersion is flat. This is an important though trivial special
case of a flat morphism. If $U \subset X$ is open then sometimes the
pullback by $j : U \to X$ of a cycle is called the {\it restriction} of the
cycle to $U$. Note that in this case the maps
$$
j^* : Z_k(X) \longrightarrow Z_k(U)
$$
are all {\it surjective}. The reason is that given any integral closed
subspace $Z' \subset U$, we can take the closure of $Z$ of $Z'$ in $X$
and think of it as a reduced closed subspace of $X$ (see
Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}).
And clearly $Z \cap U = Z'$, in other words
$j^*[Z] = [Z']$ whence the surjectivity. In fact a little bit more
is true.

\begin{lemma}
\label{lemma-exact-sequence-open}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $U \subset X$ be an open subspace. Let $Y$ be the
reduced closed subspace of $X$ with $|Y| = |X| \setminus |U|$
and denote $i : Y \to X$ the inclusion morphism.
For every $k \in \mathbf{Z}$ the sequence
$$
\xymatrix{
Z_k(Y) \ar[r]^{i_*} & Z_k(X) \ar[r]^{j^*} & Z_k(U) \ar[r] & 0
}
$$
is an exact complex of abelian groups.
\end{lemma}

\begin{proof}
Surjectivity of $j^*$ we saw above.
First assume $X$ is quasi-compact. Then $Z_k(X)$ is a free $\mathbf{Z}$-module
with basis given by the elements $[Z]$ where $Z \subset X$ is integral
closed of $\delta$-dimension $k$. Such a basis element maps
either to the basis element $[Z \cap U]$ of $Z_k(U)$
or to zero if $Z \subset Y$.
Hence the lemma is clear in this case. The general case is similar
and the proof is omitted.
\end{proof}

\begin{lemma}
\label{lemma-etale-pullback}
In Situation \ref{situation-setup} let $f : X \to Y$ be an \'etale
morphism of good algebraic spaces over $B$. If $Z \subset Y$ is an integral
closed subspace, then $f^*[Z] = \sum [Z']$ where the sum is over the
irreducible components (Remark \ref{remark-irreducible-component})
of $f^{-1}(Z)$.
\end{lemma}

\begin{proof}
The meaning of the lemma is that the coefficient of $[Z']$ is $1$.
This follows from the fact that $f^{-1}(Z)$ is a reduced algebraic space
because it is \'etale over the integral algebraic space $Z$.
\end{proof}

\begin{lemma}
\label{lemma-compose-flat-pullback}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be flat morphisms of relative dimensions
$r$ and $s$ over $B$. Then $g \circ f$ is flat of relative dimension
$r + s$ and
$$
f^* \circ g^* = (g \circ f)^*
$$
as maps $Z_k(Z) \to Z_{k + r + s}(X)$.
\end{lemma}

\begin{proof}
The composition is flat of relative dimension $r + s$ by
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point-additive} and
\ref{spaces-morphisms-lemma-composition-flat}.
Suppose that
\begin{enumerate}
\item $A \subset Z$ is a closed integral subspace of $\delta$-dimension $k$,
\item $A' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s$ with $A' \subset g^{-1}(A)$, and
\item $A'' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s + r$ with $A'' \subset f^{-1}(W')$.
\end{enumerate}
We have to show that the coefficient $n$ of $[A'']$ in $(g \circ f)^*[A]$
agrees with the coefficient $m$ of $[A'']$ in $f^*(g^*[A])$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \ar[r] & W \ar[d] \\
X \ar[r] & Y \ar[r] & Z
}
$$
where $U, V, W$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$, $w \in W$ such that
$u \mapsto v \mapsto w$ and such that $u, v, w$ map to the generic
points of $A'', A', A$. (Details omitted.)
Then we have flat local ring homorphisms
$\mathcal{O}_{W, w} \to \mathcal{O}_{V, v}$,
$\mathcal{O}_{V, v} \to \mathcal{O}_{U, u}$,
and repeatedly using Lemma \ref{lemma-length}
we find
$$
n = \text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_w\mathcal{O}_{U, u})
$$
and
$$
m =
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{V, v}/\mathfrak m_w\mathcal{O}_{V, v})
\text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_v\mathcal{O}_{U, u})
$$
Hence the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-transitive}.
\end{proof}

\begin{lemma}
\label{lemma-pullback-coherent}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be a closed subspace with
$\dim_\delta(Z) \leq k$. Then we have
$\dim_\delta(f^{-1}(Z)) \leq k + r$
and $[f^{-1}(Z)]_{k + r} = f^*[Z]_k$ in $Z_{k + r}(X)$.
\item Let $\mathcal{F}$ be a coherent sheaf on $Y$ with
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Then we have $\dim_\delta(\text{Supp}(f^*\mathcal{F})) \leq k + r$
and
$$
f^*[{\mathcal F}]_k = [f^*{\mathcal F}]_{k+r}
$$
in $Z_{k + r}(X)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from part (2) by Lemma \ref{lemma-cycle-closed-coherent}
and the fact that $f^*\mathcal{O}_Z = \mathcal{O}_{f^{-1}(Z)}$.

\medskip\noindent
Proof of (2).
As $X$, $Y$ are locally Noetherian we may apply
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
to see
that $\mathcal{F}$ is of finite type, hence $f^*\mathcal{F}$ is
of finite type (Modules on Sites, Lemma
\ref{sites-modules-lemma-local-pullback}),
hence $f^*\mathcal{F}$ is coherent
(Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
again).
Thus the lemma makes sense. Let $W \subset Y$ be an integral closed
subspace of $\delta$-dimension $k$, and let $W' \subset X$ be
an integral closed subspace of dimension $k + r$ mapping into $W$
under $f$. We have to show that the coefficient $n$ of
$[W']$ in $f^*[{\mathcal F}]_k$ agrees with the coefficient
$m$ of $[W']$ in $[f^*{\mathcal F}]_{k+r}$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U, V$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$ such that
$u \mapsto v$ and such that $u, v$ map to the generic
points of $W', W$. (Details omitted.)
Consider the stalk $M = (\mathcal{F}|_V)_v$ as an $\mathcal{O}_{V, v}$-module.
(Note that $M$ has finite length by our dimension assumptions, but we
actually do not need to verify this. See Lemma \ref{lemma-length-finite}.)
We have
$(f^*\mathcal{F}|_U)_u = \mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M$.
Thus we see that
$$
n = \text{length}_{\mathcal{O}_{U, u}}
(\mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M)
\quad
\text{and}
\quad
m = \text{length}_{\mathcal{O}_{V, v}}(M)
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{U, u}/\mathfrak m_v \mathcal{O}_{U, u})
$$
Thus the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}.
\end{proof}









\section{Push and pull}
\label{section-push-pull}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
In this section we verify that proper pushforward and flat pullback
are compatible when this makes sense. By the work we did above this
is a consequence of cohomology and base change.

\begin{lemma}
\label{lemma-flat-pullback-proper-pushforward}
In Situation \ref{situation-setup} let
$$
\xymatrix{
X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\
Y' \ar[r]^g & Y
}
$$
be a fibre product diagram of good algebraic spaces over $B$.
Assume $f : X \to Y$ proper and $g : Y' \to Y$ flat of relative dimension $r$.
Then also $f'$ is proper and $g'$ is flat of relative dimension $r$.
For any $k$-cycle $\alpha$ on $X$ we have
$$
g^*f_*\alpha = f'_*(g')^*\alpha
$$
in $Z_{k + r}(Y')$.
\end{lemma}

\begin{proof}
The assertion that $f'$ is proper follows from
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-proper}.
The assertion that $g'$ is flat of relative dimension $r$ follows from
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-after-base-change}
and \ref{spaces-morphisms-lemma-base-change-flat}.
It suffices to prove the equality of cycles when $\alpha = [W]$
for some integral closed subspace $W \subset X$ of $\delta$-dimension $k$.
Note that in this case we have $\alpha = [\mathcal{O}_W]_k$, see
Lemma \ref{lemma-cycle-closed-coherent}.
By Lemmas \ref{lemma-cycle-push-sheaf} and
\ref{lemma-pullback-coherent} it therefore suffices
to show that $f'_*(g')^*\mathcal{O}_W$ is isomorphic to
$g^*f_*\mathcal{O}_W$. This follows from cohomology and
base change, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-flat-base-change-cohomology}.
\end{proof}

\begin{lemma}
\label{lemma-finite-flat}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a finite locally free morphism
of degree $d$ (see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-finite-locally-free}).
Then $f$ is both proper and flat of relative dimension $0$, and
$$
f_*f^*\alpha = d\alpha
$$
for every $\alpha \in Z_k(Y)$.
\end{lemma}

\begin{proof}
A finite locally free morphism is flat and finite by
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-flat},
and a finite morphism is proper
by Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-proper}.
We omit showing that a finite
morphism has relative dimension $0$. Thus the formula makes sense.
To prove it, let $Z \subset Y$ be an integral closed subscheme
of $\delta$-dimension $k$. It suffices to prove the formula
for $\alpha = [Z]$. Since the base change of a finite locally free
morphism is finite locally free
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-locally-free})
we see that $f_*f^*\mathcal{O}_Z$ is a finite locally free sheaf of
rank $d$ on $Z$. Thus clearly $f_*f^*\mathcal{O}_Z$ has length $d$
at the generic point of $Z$. Hence
$$
f_*f^*[Z] = f_*f^*[\mathcal{O}_Z]_k =
[f_*f^*\mathcal{O}_Z]_k = d[Z]
$$
where we have used Lemmas \ref{lemma-pullback-coherent} and
\ref{lemma-cycle-push-sheaf}.
\end{proof}










\section{Preparation for principal divisors}
\label{section-preparation-principal-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-principal-divisors}.
Some of the material in this section partially overlaps with the
discussion in Spaces over Fields, Section
\ref{spaces-over-fields-section-Weil-divisors}.

\begin{lemma}
\label{lemma-divisor-delta-dimension}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is
integral.
\begin{enumerate}
\item If $Z \subset X$ is an integral closed subspace, then
the following are equivalent:
\begin{enumerate}
\item $Z$ is a prime divisor,
\item $|Z|$ has codimension $1$ in $|X|$, and
\item $\dim_\delta(Z) = \dim_\delta(X) - 1$.
\end{enumerate}
\item If $Z$ is an irreducible component of an effective Cartier
divisor on $X$, then $\dim_\delta(Z) = \dim_\delta(X) - 1$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from the definition of a prime divisor
(Spaces over Fields, Definition
\ref{spaces-over-fields-definition-Weil-divisor}),
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring},
and the definition of a dimension function
(Topology, Definition \ref{topology-definition-dimension-function}).

\medskip\noindent
Let $D \subset X$ be an effective Cartier divisor. Let $Z \subset D$
be an irreducible component and let $\xi \in |Z|$ be the generic point.
Choose an \'etale neighbourhood $(U, u) \to (X, \xi)$ where $U = \Spec(A)$
and $D \times_X U$ is cut out by a nonzerodivisor $f \in A$, see
Divisors on Spaces, Lemma
\ref{spaces-divisors-lemma-characterize-effective-Cartier-divisor}.
Then $u$ is a generic point of $V(f)$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-generic-points}.
Hence $\mathcal{O}_{U, u}$ has dimension $1$ by
Krull's Hauptidealsatz (Algebra, Lemma \ref{algebra-lemma-minimal-over-1}).
Thus $\xi$ is a codimension $1$ point on $X$ and $Z$ is a prime
divisor as desired.
\end{proof}












\section{Principal divisors}
\label{section-principal-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-principal-divisors}.
The following definition is the analogue of
Spaces over Fields, Definition
\ref{spaces-over-fields-definition-principal-divisor}
in our current setup.

\begin{definition}
\label{definition-principal-divisor}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is
integral with $\dim_\delta(X) = n$.
Let $f \in R(X)^*$. The {\it principal divisor associated to $f$}
is the $(n - 1)$-cycle
$$
\text{div}(f) = \text{div}_X(f) = \sum \text{ord}_Z(f) [Z]
$$
defined in Spaces over Fields, Definition
\ref{spaces-over-fields-definition-principal-divisor}.
This makes sense because prime divisors have $\delta$-dimension $n - 1$ by
Lemma \ref{lemma-divisor-delta-dimension}.
\end{definition}

\noindent
In the situation of the definition for $f, g \in R(X)^*$ we have
$$
\text{div}_X(fg) = \text{div}_X(f) + \text{div}_X(g)
$$
in $Z_{n - 1}(X)$. See Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-div-additive}.
The following lemma will allow us to reduce
statements about principal divisors to the case of schemes.

\begin{lemma}
\label{lemma-etale-pullback-principal-divisor}
In Situation \ref{situation-setup} let $f : X \to Y$ be an \'etale
morphism of good algebraic spaces over $B$. Assume $Y$ is integral.
Let $g \in R(Y)^*$. As cycles on $X$ we have
$$
f^*(\text{div}_Y(g)) =
\sum\nolimits_{X'} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'})
$$
where the sum is over the irreducible components of $X$
(Remark \ref{remark-irreducible-component}).
\end{lemma}

\begin{proof}
The map $|X| \to |Y|$ is open. The set of irreducible components of $|X|$
is locally finite in $|X|$. We conclude that $f|_{X'} : X' \to Y$
is dominant for every irreducible component $X' \subset X$.
Thus $g \circ f|_{X'}$ is defined (Morphisms of Spaces, Section
\ref{spaces-morphisms-section-rational-maps}), hence
$\text{div}_{X'}(g \circ f|_{X'})$ is defined. Moreover, the
sum is locally finite and we find that the right hand side indeed
is a cycle on $X$. The left hand side is defined by
Definition \ref{definition-flat-pullback}
and the fact that an \'etale morphism is flat of relative dimension $0$.

\medskip\noindent
Since $f$ is \'etale we see that $\delta_X(x) = \delta_y(f(x))$
for all $x \in |X|$. Thus if $\dim_\delta(Y) = n$, then $\dim_\delta(X') = n$
for every irreducible component $X'$ of $X$ (since generic points of $X$
map to the generic point of $Y$, see above). Thus both left
and right hand side are $(n - 1)$-cycles.

\medskip\noindent
Let $Z \subset X$ be an integral closed subspace with $\dim_\delta(Z) = n - 1$.
To prove the equality, we need to show that the coefficients
of $Z$ are the same. Let $Z' \subset Y$ be the integral closed
subspace constructed in Lemma \ref{lemma-proper-image}.
Then $\dim_\delta(Z') = n - 1$ too. Let $\xi \in |Z|$ be the generic point.
Then $\xi' = f(\xi) \in |Z'|$ is the generic point.
Consider the commutative diagram
$$
\xymatrix{
\Spec(\mathcal{O}_{X, \xi}^h) \ar[r] \ar[d] & X \ar[d] \\
\Spec(\mathcal{O}_{Y, \xi'}^h) \ar[r] & Y
}
$$
of Decent Spaces, Remark
\ref{decent-spaces-remark-functoriality-henselian-local-ring}.
We have to be slightly careful as the reduced Noetherian local rings
$\mathcal{O}_{X, \xi}^h$ and $\mathcal{O}_{Y, \xi'}^h$ need not be domains.
Thus we work with total rings of fractions $Q(-)$ rather than fraction fields.
By definition, to get the coefficient of $Z'$ in $\text{div}_Y(g)$
we write the image of $g$ in $Q(\mathcal{O}_{Y, \xi'}^h)$
as $a/b$ with $a, b \in \mathcal{O}_{Y, \xi'}^h$ nonzerodivisors
and we take
$$
\text{ord}_{Z'}(g) =
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) -
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/b \mathcal{O}_{Y, \xi'}^h)
$$
Observe that the coefficient of $Z$ in $f^*\text{div}_Y(G)$
is the same integer, see Lemma \ref{lemma-etale-pullback}.
Suppose that $\xi \in X'$. Then we can consider the maps
$$
\mathcal{O}_{Y, \xi'}^h \to
\mathcal{O}_{X, \xi}^h \to
\mathcal{O}_{X', \xi}^h
$$
The first arrow is flat and the second arrow is a surjective
map of reduced local Noetherian rings of dimension $1$.
Therefore both these maps send nonzerodivisors to nonzerodivisors
and we conclude the coefficient of $Z'$ in $\text{div}_{X'}(g \circ f|_{X'})$
is
$$
\text{ord}_Z(g \circ f|_{X'}) =
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h) -
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{X', \xi}^h/b \mathcal{O}_{X', \xi}^h)
$$
by the same prescription as above. Thus it suffices to show
$$
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) =
\sum\nolimits_{\xi \in |X'|}
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h)
$$
First, since the ring map $\mathcal{O}_{Y, \xi'}^h \to
\mathcal{O}_{X, \xi}^h$ is flat and unramified, we have
$$
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) =
\text{length}_{\mathcal{O}_{X, \xi}^h}
(\mathcal{O}_{X, \xi}^h/a \mathcal{O}_{X, \xi}^h)
$$
by Algebra, Lemma \ref{algebra-lemma-pullback-module}.
Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the nonmaximal
primes of $\mathcal{O}_{X, \xi}^h$ and set
$R_j = \mathcal{O}_{X, \xi}^h/\mathfrak q_j$.
For $X'$ as above, denote $J(X') \subset \{1, \ldots, t\}$
the set of indices such that $\mathfrak q_j$ corresponds
to a point of $X'$, i.e., such that under the surjection
$\mathcal{O}_{X, \xi}^h \to \mathcal{O}_{X', \xi}$
the prime $\mathfrak q_j$ corresponds to a prime
of $\mathcal{O}_{X', \xi}$.
By Chow Homology, Lemma \ref{chow-lemma-additivity-divisors-restricted}
we get
$$
\text{length}_{\mathcal{O}_{X, \xi}^h}
(\mathcal{O}_{X, \xi}^h/a \mathcal{O}_{X, \xi}^h) =
\sum\nolimits_j \text{length}_{R_j}(R_j/a R_j)
$$
and
$$
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h) =
\sum\nolimits_{j \in J(X')} \text{length}_{R_j}(R_j/a R_j)
$$
Thus the result of the lemma holds because
$\{1, \ldots, t\}$ is the disjoint union of the sets $J(X')$:
each point of codimension $0$ on $X$ lies on a unique $X'$.
\end{proof}







\section{Principal divisors and pushforward}
\label{section-two-fun}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-two-fun}.

\begin{lemma}
\label{lemma-proper-pushforward-alteration}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Assume $X$, $Y$ are integral and $n = \dim_\delta(X) = \dim_\delta(Y)$.
Let $p : X \to Y$ be a dominant proper morphism.
Let $f \in R(X)^*$. Set
$$
g = \text{Nm}_{R(X)/R(Y)}(f).
$$
Then we have
$p_*\text{div}(f) = \text{div}(g)$.
\end{lemma}

\begin{proof}
We are going to deduce this from the case of schemes by \'etale localization.
Let $Z \subset Y$ be an integral closed subspace of $\delta$-dimension
$n - 1$. We want to show that the coefficient of $[Z]$ in
$p_*\text{div}(f)$ and $\text{div}(g)$ are equal. Apply
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-in-codim-1}
to the morphism $p : X \to Y$ and the generic point $\xi \in |Z|$.
We find that we may replace $Y$ by an open subspace containing $\xi$
and assume that $p : X \to Y$ is finite. Pick an \'etale neighbourhood
$(V, v) \to (Y, \xi)$ where $V$ is an affine scheme.
By Lemma \ref{lemma-etale-pullback} it suffices to prove the equality
of cycles after pulling back to $V$.
Set $U = V \times_Y X$ and consider the commutative diagram
$$
\xymatrix{
U \ar[r]_a \ar[d]_{p'} & X \ar[d]^p \\
V \ar[r]^b & Y
}
$$
Let $V_j \subset V$, $j = 1, \ldots, m$ be the irreducible components
of $V$. For each $i$, let $U_{j, i}$, $i = 1, \ldots, n_j$ be the
irreducible components of $U$ dominating $V_j$. Denote
$p'_{j, i} : U_{j, i} \to V_j$ the restriction of $p' : U \to V$.
By the case of schemes
(Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-alteration})
we see that
$$
p'_{j, i, *}\text{div}_{U_{j, i}}(f_{j, i}) = \text{div}_{V_j}(g_{j, i})
$$
where $f_{j, i}$ is the restriction of $f$ to $U_{j, i}$ and
$g_{j, i}$ is the norm of $f_{j, i}$ along the finite extension
$R(U_{j, i})/R(V_j)$. We have
\begin{align*}
b^* p_*\text{div}_X(f)
& =
p'_* a^* \text{div}_X(f) \\
& =
p'_*\left(\sum\nolimits_{j, i}
(U_{j, i} \to U)_*\text{div}_{U_{j, i}}(f_{j, i})\right) \\
& =
\sum\nolimits_{j, i}
(V_j \to V)_*p'_{j, i, *}\text{div}_{U_{j, i}}(f_{j, i}) \\
& =
\sum\nolimits_j
(V_j \to V)_*\left(\sum\nolimits_i \text{div}_{V_j}(g_{j, i})\right) \\
& =
\sum\nolimits_j (V_j \to V)_*\text{div}_{V_j}(\prod\nolimits_i g_{j, i})
\end{align*}
by Lemmas
\ref{lemma-flat-pullback-proper-pushforward},
\ref{lemma-etale-pullback-principal-divisor}, and
\ref{lemma-compose-pushforward}.
To finish the proof, using Lemma \ref{lemma-etale-pullback-principal-divisor}
again, it suffices to show that
$$
g \circ b|_{V_j} = \prod\nolimits_i g_{j, i}
$$
as elements of the function field of $V_j$. In terms of fields
this is the following statement: let $L/K$ be a finite extension.
Let $M/K$ be a finite separable extension. Write
$M \otimes_K L = \prod M_i$. Then for $t \in L$ with images
$t_i \in M_i$ the image of
$\text{Norm}_{L/K}(t)$ in $M$ is $\prod \text{Norm}_{M_i/M}(t_i)$.
We omit the proof.
\end{proof}







\section{Rational equivalence}
\label{section-rational-equivalence}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-rational-equivalence}.
In this section we define {\it rational equivalence} on $k$-cycles.
We will allow locally finite sums of images of
principal divisors (under closed immersions). This leads to some
pretty strange phenomena (see examples in the chapter on schemes).
However, if we do not allow these then we do not know how to prove that
capping with chern classes of line bundles factors through rational
equivalence.

\begin{definition}
\label{definition-rational-equivalence}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $k \in \mathbf{Z}$.
\begin{enumerate}
\item Given any locally finite collection $\{W_j \subset X\}$
of integral closed subspaces with $\dim_\delta(W_j) = k + 1$,
and any $f_j \in R(W_j)^*$ we may consider
$$
\sum (i_j)_*\text{div}(f_j) \in Z_k(X)
$$
where $i_j : W_j \to X$ is the inclusion morphism.
This makes sense as the morphism
$\coprod i_j : \coprod W_j \to X$ is proper.
\item We say that $\alpha \in Z_k(X)$ is {\it rationally equivalent to zero}
if $\alpha$ is a cycle of the form displayed above.
\item We say $\alpha, \beta \in Z_k(X)$ are
{\it rationally equivalent} and we write $\alpha \sim_{rat} \beta$
if $\alpha - \beta$ is rationally equivalent to zero.
\item We define
$$
A_k(X) = Z_k(X) / \sim_{rat}
$$
to be the {\it Chow group of $k$-cycles on $X$}. This is sometimes called
the {\it Chow group of $k$-cycles modulo rational equivalence on $X$}.
\end{enumerate}
\end{definition}

\noindent
There are many other interesting equivalence relations.
Rational equivalence is the coarsest of them all.
A very simple but important lemma is the following.

\begin{lemma}
\label{lemma-restrict-to-open}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $U \subset X$ be an open subspace. Let $Y$ be the
reduced closed subspace of $X$ with $|Y| = |X| \setminus |U|$
and denote $i : Y \to X$ the inclusion morphism. Let $k \in \mathbf{Z}$.
Suppose $\alpha, \beta \in Z_k(X)$. If $\alpha|_U \sim_{rat} \beta|_U$
then there exist a cycle $\gamma \in Z_k(Y)$ such that
$$
\alpha \sim_{rat} \beta + i_*\gamma.
$$
In other words, the sequence
$$
\xymatrix{
A_k(Y) \ar[r]^{i_*} & A_k(X) \ar[r]^{j^*} & A_k(U) \ar[r] & 0
}
$$
is an exact complex of abelian groups.
\end{lemma}

\begin{proof}
Let $\{W_j\}_{j \in J}$ be a locally finite collection of integral closed
subspaces of $U$ of $\delta$-dimension $k + 1$, and let $f_j \in R(W_j)^*$
be elements such that $(\alpha - \beta)|_U = \sum (i_j)_*\text{div}(f_j)$
as in the definition. Let $W_j' \subset X$ be the corresponding integral
closed subspace of $X$, i.e., having the same generic point as $W_j$.
Suppose that $V \subset X$ is a quasi-compact open.
Then also $V \cap U$ is quasi-compact open in $U$ as $V$ is Noetherian.
Hence the set $\{j \in J \mid W_j \cap V \not = \emptyset\}
= \{j \in J \mid W'_j \cap V \not = \emptyset\}$
is finite since $\{W_j\}$ is locally finite. In other words we see that
$\{W'_j\}$ is also locally finite. Since $R(W_j) = R(W'_j)$ we see
that
$$
\alpha - \beta - \sum (i'_j)_*\text{div}(f_j)
$$
is a cycle on $X$ whose restriction to $U$ is zero.
The lemma follows by applying Lemma \ref{lemma-exact-sequence-open}.
\end{proof}

\begin{remark}
\label{remark-infinite-sums-rational-equivalences}
In Situation \ref{situation-setup} let $X/B$ be good.
Suppose we have infinite collections $\alpha_i, \beta_i \in Z_k(X)$,
$i \in I$ of $k$-cycles on $X$. Suppose that the supports
of $\alpha_i$ and $\beta_i$ form locally finite collections
of closed subsets of $X$ so that $\sum \alpha_i$
and $\sum \beta_i$ are defined as cycles. Moreover, assume that
$\alpha_i \sim_{rat} \beta_i$ for each $i$. Then it is not
clear that $\sum \alpha_i \sim_{rat} \sum \beta_i$. Namely,
the problem is that the rational equivalences may be
given by locally finite
families $\{W_{i, j}, f_{i, j} \in R(W_{i, j})^*\}_{j \in J_i}$
but the union $\{W_{i, j}\}_{i \in I, j\in J_i}$ may not
be locally finite.

\medskip\noindent
In many cases in practice, one has a locally finite family of closed
subsets $\{T_i\}_{i \in I}$ of $|X|$ such that $\alpha_i, \beta_i$
are supported on $T_i$ and such that $\alpha_i \sim_{rat} \beta_i$
``on'' $T_i$. More precisely, the families
$\{W_{i, j}, f_{i, j} \in R(W_{i, j})^*\}_{j \in J_i}$
consist of integral closed subspaces $W_{i, j}$
with $|W_{i, j}| \subset T_i$. In this case it is true that
$\sum \alpha_i \sim_{rat} \sum \beta_i$ on $X$, simply because
the family $\{W_{i, j}\}_{i \in I, j\in J_i}$ is automatically
locally finite in this case.
\end{remark}











\section{Rational equivalence and push and pull}
\label{section-properties-rational-equivalence}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-properties-rational-equivalence}.
In this section we show that flat pullback and proper pushforward
commute with rational equivalence.

\begin{lemma}
\label{lemma-prepare-flat-pullback-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Assume $Y$ integral with $\dim_\delta(Y) = k$.
Let $f : X \to Y$ be a flat morphism of
relative dimension $r$. Then for $g \in R(Y)^*$ we have
$$
f^*\text{div}_Y(g) =
\sum m_{X', X} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'})
$$
as $(k + r - 1)$-cycles on $X$ where the sum is over the irreducible
components $X'$ of $X$ and $m_{X', X}$ is the multiplicity of $X'$ in $X$.
\end{lemma}

\begin{proof}
Observe that any irreducible component of $X$ dominates $Y$
(Lemma \ref{lemma-flat-inverse-image-dimension})
and hence the composition $g \circ f|_{X'}$ is defined
(Morphisms of Spaces, Section \ref{spaces-morphisms-section-rational-maps}).
We will reduce this to the case of schemes. Choose a scheme $V$ and a
surjective \'etale morphism $V \to Y$. Choose a scheme $U$ and a surjective
\'etale morphism $U \to V \times_Y X$. Picture
$$
\xymatrix{
U \ar[r]_a \ar[d]_h & X \ar[d]^f \\
V \ar[r]^b & Y
}
$$
Since $a$ is surjective and \'etale it follows from
Lemma \ref{lemma-etale-pullback} that it suffices to prove the
equality of cycles after pulling back by $a$.
We can use Lemma \ref{lemma-etale-pullback-principal-divisor} to write
$$
b^*\text{div}_Y(g) = \sum (V' \to V)_*\text{div}_{V'}(g \circ b|_{V'})
$$
where the sum is over the irreducible components $V'$ of $V$.
Using Lemma \ref{lemma-flat-pullback-proper-pushforward} we find
$$
h^*b^*\text{div}_Y(g) =
\sum (V' \times_V U \to U)_*(h')^*\text{div}_{V'}(g \circ b|_{V'})
$$
where $h' : V' \times_V U \to V'$ is the projection.
We may apply the lemma in the case of schemes
(Chow Homology, Lemma
\ref{chow-lemma-prepare-flat-pullback-rational-equivalence})
to the morphism $h' : V' \times_V U \to V'$ to see that we have
$$
(h')^*\text{div}_{V'}(g \circ b|_{V'}) =
\sum
m_{U', V' \times_V U}
(U' \to V' \times_V U)_*\text{div}_{U'}(g \circ b|_{V'} \circ h'|_{U'})
$$
where the sum is over the irreducible components $U'$ of $V' \times_V U$.
Each $U'$ occurring in this sum is an irreducible component of $U$
and conversely every irreducible component $U'$ of $U$ is an
irreducible component of $V' \times_V U$
for a unique irreducible component $V' \subset V$.
Given an irreducible component $U' \subset U$,
denote $\overline{a(U')} \subset X$ the ``image'' in $X$
(Lemma \ref{lemma-proper-image}); this
is an irreducible component of $X$ for example by
Lemma \ref{lemma-flat-inverse-image-dimension}.
The muplticity $m_{U', V' \times_V U}$ is equal to
the multiplicity $m_{\overline{a(U')}, X}$.
This follows from the equality $h^*a^*[Y] = b^*f^*[Y]$
(Lemma \ref{lemma-compose-flat-pullback}), the definitions, and
Lemma \ref{lemma-etale-pullback}.
Combining all of what we just said we obtain
$$
a^*f^*\text{div}_Y(g) =
h^*b^*\text{div}_Y(g) =
\sum m_{\overline{a(U')}, X}
(U' \to U)_*\text{div}_{U'}(g \circ (f \circ a)|_{U'})
$$
Next, we analyze what happens with the right hand side of the
formula in the statement of the lemma if we pullback by $a$.
First, we use Lemma \ref{lemma-flat-pullback-proper-pushforward}
to get
$$
a^*\sum m_{X', X} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'}) =
\sum m_{X', X} (X' \times_X U \to U)_*(a')^*\text{div}_{X'}(g \circ f|_{X'})
$$
where $a' : X' \times_X U \to X'$ is the projection.
By Lemma \ref{lemma-etale-pullback-principal-divisor}
we get
$$
(a')^*\text{div}_{X'}(g \circ f|_{X'}) =
\sum (U' \to X' \times_X U)_*\text{div}_{U'}(g \circ (f \circ a)|_{U'})
$$
where the sum is over the irreducible components $U'$ of $X' \times_X U$.
These $U'$ are irreducible components of $U$ and in fact are exactly the
irreducible components of $U$ such that $\overline{a(U')} = X'$.
Comparing with what we obtained above we conclude.
\end{proof}

\begin{lemma}
\label{lemma-flat-pullback-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
Let $\alpha \sim_{rat} \beta$ be rationally equivalent $k$-cycles
on $Y$. Then $f^*\alpha \sim_{rat} f^*\beta$ as $(k + r)$-cycles on $X$.
\end{lemma}

\begin{proof}
What do we have to show? Well, suppose we are given a collection
$$
i_j : W_j \longrightarrow Y
$$
of closed immersions, with each $W_j$ integral of $\delta$-dimension $k + 1$
and rational functions $g_j \in R(W_j)^*$. Moreover, assume that
the collection $\{|i_j|(|W_j|)\}_{j \in J}$ is locally finite in $|Y|$.
Then we have to show that
$$
f^*(\sum i_{j, *}\text{div}(g_j)) = \sum f^*i_{j, *}\text{div}(g_j)
$$
is rationally equivalent to zero on $X$. The sum on the right
makes sense by Lemma \ref{lemma-inverse-image-locally-finite}.

\medskip\noindent
Consider the fibre products
$$
i'_j : W'_j = W_j \times_Y X \longrightarrow X.
$$
and denote $f_j : W'_j \to W_j$ the first projection.
By Lemma \ref{lemma-flat-pullback-proper-pushforward}
we can write the sum above as
$$
\sum i'_{j, *}(f_j^*\text{div}(g_j))
$$
By Lemma \ref{lemma-prepare-flat-pullback-rational-equivalence}
we see that each $f_j^*\text{div}(g_j)$ is rationally equivalent
to zero on $W'_j$. Hence each $i'_{j, *}(f_j^*\text{div}(g_j))$
is rationally equivalent to zero. Then the same is true for
the displayed sum by the discussion in
Remark \ref{remark-infinite-sums-rational-equivalences}.
\end{proof}

\begin{lemma}
\label{lemma-proper-pushforward-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $p : X \to Y$ be a proper morphism.
Suppose $\alpha, \beta \in Z_k(X)$ are rationally equivalent.
Then $p_*\alpha$ is rationally equivalent to $p_*\beta$.
\end{lemma}

\begin{proof}
What do we have to show? Well, suppose we are given a collection
$$
i_j : W_j \longrightarrow X
$$
of closed immersions, with each $W_j$ integral of $\delta$-dimension $k + 1$
and rational functions $f_j \in R(W_j)^*$.
Moreover, assume that
the collection $\{i_j(W_j)\}_{j \in J}$ is locally finite on $X$.
Then we have to show that
$$
p_*\left(\sum i_{j, *}\text{div}(f_j)\right)
$$
is rationally equivalent to zero on $X$.

\medskip\noindent
Note that the sum is equal to
$$
\sum p_*i_{j, *}\text{div}(f_j).
$$
Let $W'_j \subset Y$ be the integral closed subspace which is the
image of $p \circ i_j$, see Lemma \ref{lemma-proper-image}.
The collection $\{W'_j\}$ is locally finite
in $Y$ by Lemma \ref{lemma-quasi-compact-locally-finite}.
Hence it suffices to show, for a given $j$, that either
$p_*i_{j, *}\text{div}(f_j) = 0$ or that it
is equal to $i'_{j, *}\text{div}(g_j)$ for some $g_j \in R(W'_j)^*$.

\medskip\noindent
The arguments above therefore reduce us to the case of a since
integral closed subspace $W \subset X$ of $\delta$-dimension $k + 1$.
Let $f \in R(W)^*$. Let $W' = p(W)$ as above.
We get a commutative diagram of morphisms
$$
\xymatrix{
W \ar[r]_i \ar[d]_{p'} & X \ar[d]^p \\
W' \ar[r]^{i'} & Y
}
$$
Note that $p_*i_*\text{div}(f) = i'_*(p')_*\text{div}(f)$ by
Lemma \ref{lemma-compose-pushforward}. As explained above
we have to show that $(p')_*\text{div}(f)$
is the divisor of a rational function on $W'$ or zero.
There are three cases to distinguish.

\medskip\noindent
The case $\dim_\delta(W') < k$. In this case automatically
$(p')_*\text{div}(f) = 0$ and there is nothing to prove.

\medskip\noindent
The case $\dim_\delta(W') = k$. Let us show that $(p')_*\text{div}(f) = 0$
in this case. Since $(p')_*\text{div}(f)$ is a $k$-cycle, we see
that $(p')_*\text{div}(f) = n[W']$ for some $n \in \mathbf{Z}$.
In order to prove that $n = 0$ we may replace $W'$ by
a nonempty open subspace. In particular, we may and
do assume that $W'$ is a scheme. Let $\eta \in W'$ be the generic point.
Let $K = \kappa(\eta) = R(W')$ be the function field.
Consider the base change diagram
$$
\xymatrix{
W_\eta \ar[r] \ar[d]_c & W \ar[d]^{p'} \\
\Spec(K) \ar[r]^\eta & W'
}
$$
Observe that $c$ is proper. Also $|W_\eta|$ has dimension $1$:
use Decent Spaces, Lemma \ref{decent-spaces-lemma-topology-fibre}
to identify $|W_\eta|$ as the subspace of $|W|$ of points mapping to $\eta$
and note that since $\dim_\delta(W) = k + 1$ and $\delta(\eta) = k$
points of $W_\eta$ must have $\delta$-value either $k$ or $k + 1$.
Thus the local rings have dimension $\leq 1$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring}.
By Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-codim-1-point-in-schematic-locus}
we find that $W_\eta$ is a scheme.
Since $\Spec(K)$ is the limit of the nonempty affine open subschemes of $W'$
we conclude that we may assume that $W$ is a scheme by
Limits of Spaces, Lemma \ref{spaces-limits-lemma-limit-is-scheme}.
Then finally by the case of schemes
(Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-rational-equivalence})
we find that $n = 0$.

\medskip\noindent
The case $\dim_\delta(W') = k + 1$. In this case
Lemma \ref{lemma-proper-pushforward-alteration} applies,
and we see that indeed $p'_*\text{div}(f) = \text{div}(g)$
for some $g \in R(W')^*$ as desired.
\end{proof}












\section{The divisor associated to an invertible sheaf}
\label{section-divisor-invertible-sheaf}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-divisor-invertible-sheaf}.
The following definition is the analogue of
Spaces over Fields, Definition
\ref{spaces-over-fields-definition-divisor-invertible-sheaf}
in our current setup.

\begin{definition}
\label{definition-divisor-invertible-sheaf}
In Situation \ref{situation-setup} let $X/B$ be good.
Assume $X$ is integral and $n = \dim_\delta(X)$.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
\begin{enumerate}
\item For any nonzero meromorphic section $s$ of $\mathcal{L}$
we define the {\it Weil divisor associated to $s$} is the
$(n - 1)$-cycle
$$
\text{div}_\mathcal{L}(s) =
\sum \text{ord}_{Z, \mathcal{L}}(s) [Z]
$$
defined in Spaces over Fields, Definition
\ref{spaces-over-fields-definition-divisor-invertible-sheaf}.
This makes sense because Weil divisors have $\delta$-dimension $n - 1$
by Lemma \ref{lemma-divisor-delta-dimension}.
\item We define {\it Weil divisor associated to $\mathcal{L}$} as
$$
c_1(\mathcal{L}) \cap [X] =
\text{class of }\text{div}_\mathcal{L}(s) \in A_{n - 1}(X)
$$
where $s$ is any nonzero meromorphic section of $\mathcal{L}$ over
$X$. This is well defined by
Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-divisor-meromorphic-well-defined}.
\end{enumerate}
\end{definition}

\noindent
The zero scheme of a nonzero section is an effective Cartier divisor
whose Weil divisor class computes the Weil divisor associated to
the invertible module.

\begin{lemma}
\label{lemma-compute-c1}
In Situation \ref{situation-setup} let $X/B$ be good.
Assume $X$ is integral and $n = \dim_\delta(X)$.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let $s \in \Gamma(X, \mathcal{L})$ be a nonzero global section.
Then
$$
\text{div}_\mathcal{L}(s) = [Z(s)]_{n - 1}
$$
in $Z_{n - 1}(X)$ and
$$
c_1(\mathcal{L}) \cap [X] = [Z(s)]_{n - 1}
$$
in $A_{n - 1}(X)$.
\end{lemma}

\begin{proof}
Let $Z \subset X$ be an integral closed subspace of $\delta$-dimension $n - 1$.
Let $\xi \in |Z|$ be its generic point. To prove the first equality
we compare the coefficients of $Z$ on both sides. Choose an elementary
\'etale neighbourhood $(U, u) \to (X, \xi)$, see
Decent Spaces, Section
\ref{decent-spaces-section-residue-fields-henselian-local-rings}
and recall that $\mathcal{O}_{X, \xi}^h = \mathcal{O}_{U, u}^h$
in this case. After replacing $U$ by an open neighbourhood
of $u$ we may assume there is a trivializing section
$s_U$ of $\mathcal{L}|_U$. Write $s|_U = f s_U$ for some
$f \in \Gamma(U, \mathcal{O}_U)$. Then $Z \times_X U$ is
equal to $V(f)$ as a closed subscheme of $U$, see
Divisors on Spaces, Definition \ref{spaces-divisors-definition-zero-scheme-s}.
As in Spaces over Fields, Section \ref{spaces-over-fields-section-c1}
denote $\mathcal{L}_\xi$ the pullback of $\mathcal{L}$
under the canonical morphism
$c_\xi : \Spec(\mathcal{O}_{X, \xi}^h) \to X$.
Denote $s_\xi$ the pullback of $s_U$; it is a trivialization of
$\mathcal{L}_\xi$. Then we see that
$c_\xi^*(s) = fs_\xi$. The coefficient of $Z$ in $[Z(s)]_{n - 1}$
is by definition
$$
\text{length}_{\mathcal{O}_{U, u}}(\mathcal{O}_{U, u}/f\mathcal{O}_{U, u})
$$
Since $\mathcal{O}_{U, u} \to \mathcal{O}_{X, \xi}^h$
is flat and identifies residue fields this is equal to
$$
\text{length}_{\mathcal{O}_{X, \xi}^h}
(\mathcal{O}_{X, \xi}^h/f\mathcal{O}_{X, \xi}^h)
$$
by Algebra, Lemma \ref{algebra-lemma-pullback-module}.
This final quantity is equal to $\text{ord}_{Z, \mathcal{L}}(s)$ by
Spaces over Fields, Definition
\ref{spaces-over-fields-definition-order-vanishing-meromorphic}, i.e.,
to the coefficient of $Z$ in
$\text{div}_\mathcal{L}(s)$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-Gm-torsor}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
The morphism
$$
q :
T = \underline{\Spec}\left(
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{L}^{\otimes n}\right)
\longrightarrow
X
$$
has the following properties:
\begin{enumerate}
\item $q$ is surjective, smooth, affine, of relative dimension $1$,
\item there is an isomorphism $\alpha : q^*\mathcal{L} \cong \mathcal{O}_T$,
\item formation of $(q : T \to X, \alpha)$ commutes with base change,
\item $q^* : Z_k(X) \to Z_{k + 1}(T)$ is injective,
\item if $Z \subset X$ is an integral closed subspace, then
$q^{-1}(Z) \subset T$ is an integral closed subspace,
\item if $Z \subset X$ is a closed subspace of $X$
of $\delta$-dimension $\leq k$, then $q^{-1}(Z)$ is a closed subspace of $T$
of $\delta$-dimension $\leq k + 1$ and
$q^*[Z]_k = [q^{-1}(Z)]_{k + 1}$,
\item if $\xi' \in |T|$ is the generic point of the fibre of $|T| \to |X|$
over $\xi$, then the ring map
$\mathcal{O}_{X, \xi}^h \to \mathcal{O}_{T, \xi'}^h$ is flat,
we have $\mathfrak m_{\xi'}^h = \mathfrak m_\xi^h \mathcal{O}_{T, \xi'}^h$, and
the residue field extension is purely transcendental of
transcendence degree $1$, and
\item add more here as needed.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $U \to X$ be an \'etale morphism such that $\mathcal{L}|_U$
is trivial. Then $T \times_X U \to U$ is isomorphic to the projection
morphism $\mathbf{G}_m \times U \to U$, where
$\mathbf{G}_m$ is the multipliciative group scheme, see
Groupoids, Example \ref{groupoids-example-multiplicative-group}.
Thus (1) is clear.

\medskip\noindent
To see (2) observe that
$q_*q^*\mathcal{L} =
\bigoplus_{n \in \mathbf{Z}} \mathcal{L}^{\otimes n + 1}$.
Thus there is an obvious isomorphism
$q_*q^*\mathcal{L} \to q_*\mathcal{O}_T$
of $q_*\mathcal{O}_T$-modules. By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-affine-equivalence-modules}
this determines an isomorphism $q^*\mathcal{L} \to \mathcal{O}_T$.

\medskip\noindent
Part (3) holds because forming the relative spectrum commutes
with arbitrary base change and the same thing is clearly true
for the isomorphism $\alpha$.

\medskip\noindent
Part (4) follows immediately from (1) and the definitions.

\medskip\noindent
Part (5) follows from the fact that if $Z$ is an integral algebraic
space, then $\mathbf{G}_m \times Z$ is an integral algebraic space.

\medskip\noindent
Part (6) follows from the fact that lengths are preserved:
if $(A, \mathfrak m)$ is a local ring and $B = A[x]_{\mathfrak m A[x]}$
and if $M$ is an $A$-module, then
$\text{length}_A(M) = \text{length}_B(M \otimes_A B)$.
This implies that if $\mathcal{F}$ is a coherent
$\mathcal{O}_X$-module and $\xi \in |X|$ with $\xi' \in |T|$
the generic point of the fibre over $\xi$, then
the length of $\mathcal{F}$ at $\xi$ is the same as the
length of $q^*\mathcal{F}$ at $\xi'$.
Tracing through the definitions this gives (6) and more.

\medskip\noindent
The map in part (7) comes from Decent Spaces, Remark
\ref{decent-spaces-remark-functoriality-henselian-local-ring}.
However, in our case we have
$$
\Spec(\mathcal{O}_{X, \xi}^h) \times_X T =
\mathbf{G}_m \times \Spec(\mathcal{O}_{X, \xi}^h) =
\Spec(\mathcal{O}_{X, \xi}^h[t, t^{-1}])
$$
and $\xi'$ corresponds to the generic point of the special
fibre of this over $\Spec(\mathcal{O}_{X, \xi}^h)$. Thus
$\mathcal{O}_{T, \xi'}^h$ is the henselization of the localization
of $\mathcal{O}_{X, \xi}^h[t, t^{-1}]$ at the corresponding prime.
Part (7) follows from this and some commutative algebra; details omitted.
\end{proof}

\begin{lemma}
\label{lemma-Gm-torsor-divisor-meromorphic-section}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Assume $X$ is integral. Let $s$ be a nonzero meromorphic
section of $\mathcal{L}$. Let $q : T \to X$ be the morphism
of Lemma \ref{lemma-Gm-torsor}. Then
$$
q^*\text{div}_\mathcal{L}(s) = \text{div}_T(q^*(s))
$$
where we view the pullback $q^*(s)$
as a nonzero meromorphic function on $T$
using the isomorphism $q^*\mathcal{L} \to \mathcal{O}_T$
\end{lemma}

\begin{proof}
Observe that $\text{div}_T(q^*(s)) = \text{div}_{\mathcal{O}_T}(q^*(s))$
by the compatibility between the constructions given in
Spaces over Fields, Sections
\ref{spaces-over-fields-section-Weil-divisors} and
\ref{spaces-over-fields-section-c1}.
We will show the agreement with $\text{div}_{\mathcal{O}_T}(q^*(s))$
in this proof.
We will use all the properties of $q : T \to X$ stated in
Lemma \ref{lemma-Gm-torsor} without further mention.
Let $Z \subset T$ be a prime divisor.
Then either $Z \to X$ is dominant or $Z = q^{-1}(Z')$ for some
prime divisor $Z' \subset X$.
If $Z \to X$ is dominant, then the coefficient of $Z$ in
either side of the equality of the lemma is zero.
Thus we may assume $Z = q^{-1}(Z')$ where $Z' \subset X$
is a prime divisor.
Let $\xi' \in |Z'|$ and $\xi \in |Z|$ be the generic points.
Then we obtain a commutative diagram
$$
\xymatrix{
\Spec(\mathcal{O}_{T, \xi}^h) \ar[r]_-{c_\xi} \ar[d]_h & T \ar[d]^q \\
\Spec(\mathcal{O}_{X, \xi'}^h) \ar[r]^-{c_{\xi'}} & X
}
$$
see Decent Spaces, Remark
\ref{decent-spaces-remark-functoriality-henselian-local-ring}.
Choose a trivialization $s_{\xi'}$ of
$\mathcal{L}_{\xi'} = c_{\xi'}^*\mathcal{L}$.
Then we can use the pullback $s_\xi$ of $s_{\xi'}$ via $h$
as our trivialization of $\mathcal{L}_\xi = c_\xi^* q^*\mathcal{L}$.
Write $s/s_{\xi'} = a/b$ for $a, b \in \mathcal{O}_{X, \xi'}$ nonzerodivisors.
By definition the coefficient of $Z'$ in
$\text{div}_\mathcal{L}(s)$ is
$$
\text{length}_{\mathcal{O}_{X, \xi'}^h}(
\mathcal{O}_{X, \xi'}^h/a \mathcal{O}_{X, \xi'}^h)
-
\text{length}_{\mathcal{O}_{X, \xi'}^h}(
\mathcal{O}_{X, \xi'}^h/b \mathcal{O}_{X, \xi'}^h)
$$
Since $Z = q^{-1}(Z')$, this is also the coefficient of $Z$ in
$q^*\text{div}_\mathcal{L}(s)$. Since
$\mathcal{O}_{X, \xi'}^h \to \mathcal{O}_{T, \xi}^h$
is flat the elements $a, b$ map to nonzerodivisors in
$\mathcal{O}_{T, \xi}^h$. Thus $q^*(s)/s_\xi = a/b$ in the total quotient
ring of $\mathcal{O}_{T, \xi}^h$. By definition the coefficient of
$Z$ in $\text{div}_T(q^*(s))$ is
$$
\text{length}_{\mathcal{O}_{T, \xi}^h}(
\mathcal{O}_{T, \xi}^h/a \mathcal{O}_{T, \xi}^h)
-
\text{length}_{\mathcal{O}_{T, \xi}^h}(
\mathcal{O}_{T, \xi}^h/b \mathcal{O}_{T, \xi}^h)
$$
The proof is finished because these lengths are the same as before
by Algebra, Lemma \ref{algebra-lemma-pullback-module} and the
fact that $\mathfrak m_\xi^h = \mathfrak m_{\xi'}^h\mathcal{O}_{T, \xi}^h$
shown in Lemma \ref{lemma-Gm-torsor}.
\end{proof}









\section{Intersecting with an invertible sheaf}
\label{section-intersecting-with-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-intersecting-with-divisors}.
In this section we study the following construction.

\begin{definition}
\label{definition-cap-c1}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
We define, for every integer $k$, an operation
$$
c_1(\mathcal{L}) \cap - :
Z_{k + 1}(X) \to A_k(X)
$$
called {\it intersection with the first chern class of $\mathcal{L}$}.
\begin{enumerate}
\item Given an integral closed subspace $i : W \to X$ with
$\dim_\delta(W) = k + 1$ we define
$$
c_1(\mathcal{L}) \cap [W] = i_*(c_1({i^*\mathcal{L}}) \cap [W])
$$
where the right hand side is defined in
Definition \ref{definition-divisor-invertible-sheaf}.
\item For a general $(k + 1)$-cycle $\alpha = \sum n_i [W_i]$ we set
$$
c_1(\mathcal{L}) \cap \alpha = \sum n_i c_1(\mathcal{L}) \cap [W_i]
$$
\end{enumerate}
\end{definition}

\noindent
Write each $c_1(\mathcal{L}) \cap W_i = \sum_j n_{i, j} [Z_{i, j}]$
with $\{Z_{i, j}\}_j$ a locally finite sum
of integral closed subspaces of $W_i$. Since $\{W_i\}$ is a locally
finite collection of integral closed subspaces on $X$, it follows
easily that $\{Z_{i, j}\}_{i, j}$ is a locally finite collection
of closed subspaces of $X$. Hence
$c_1(\mathcal{L}) \cap \alpha = \sum n_in_{i, j}[Z_{i, j}]$
is a cycle. Another, often more convenient, way to think about this
is to observe that the morphism $\coprod W_i \to X$ is
proper. Hence $c_1(\mathcal{L}) \cap \alpha$ can be viewed
as the pushforward of a class in $A_k(\coprod W_i) = \prod A_k(W_i)$.
This also explains why the result is well defined up to rational
equivalence on $X$.

\medskip\noindent
The main goal for the next few sections is to show that intersecting with
$c_1(\mathcal{L})$ factors through rational equivalence.
This is not a triviality.

\begin{lemma}
\label{lemma-c1-cap-additive}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$, $\mathcal{N}$ be an invertible sheaves on $X$.
Then
$$
c_1(\mathcal{L}) \cap \alpha  + c_1(\mathcal{N}) \cap \alpha =
c_1(\mathcal{L} \otimes_{\mathcal{O}_X} \mathcal{N}) \cap \alpha
$$
in $A_k(X)$ for every $\alpha \in Z_{k - 1}(X)$. Moreover,
$c_1(\mathcal{O}_X) \cap \alpha = 0$ for all $\alpha$.
\end{lemma}

\begin{proof}
The additivity follows directly from
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-c1-additive}
and the definitions. To see that $c_1(\mathcal{O}_X) \cap \alpha = 0$
consider the section $1 \in \Gamma(X, \mathcal{O}_X)$. This restricts
to an everywhere nonzero section on any integral closed subspace
$W \subset X$. Hence $c_1(\mathcal{O}_X) \cap [W] = 0$ as desired.
\end{proof}

\noindent
Recall that $Z(s) \subset X$ denotes the zero scheme of a global section
$s$ of an invertible sheaf on an algebraic space $X$, see
Divisors on Spaces, Definition \ref{spaces-divisors-definition-zero-scheme-s}.

\begin{lemma}
\label{lemma-prepare-geometric-cap}
In Situation \ref{situation-setup} let $Y/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_Y$-module.
Let $s \in \Gamma(Y, \mathcal{L})$ be a regular section and
assume $\dim_\delta(Y) \leq k + 1$.
Write $[Y]_{k + 1} = \sum n_i[Y_i]$ where $Y_i \subset Y$ are the
irreducible components of $Y$ of $\delta$-dimension $k + 1$.
Set $s_i = s|_{Y_i} \in \Gamma(Y_i, \mathcal{L}|_{Y_i})$. Then
\begin{equation}
\label{equation-equal-as-cycles}
[Z(s)]_k =  \sum n_i[Z(s_i)]_k
\end{equation}
as $k$-cycles on $Y$.
\end{lemma}

\begin{proof}
Let $\varphi : V \to Y$ be a surjective \'etale morphism where $V$
is a scheme. It suffices to prove the equality after pulling back
by $\varphi$, see Lemma \ref{lemma-etale-pullback}.
That same lemma tells us that
$\varphi^*[Y_i] = [\varphi^{-1}(Y_i)] = \sum [V_{i, j}]$
where $V_{i, j}$ are the irreducible components of $V$ lying over $Y_i$.
Hence if we first apply the case of schemes
(Chow Homology, Lemma \ref{chow-lemma-prepare-geometric-cap}) to
$\varphi^*s_i$ on $Y_i \times_Y V$ we
find that $\varphi^*[Z(s_i)]_k = [Z(\varphi^*s_i)] =
\sum [Z(s_{i, j})]_k$ where $s_{i, j}$ is the pullback
of $s$ to $V_{i, j}$. Applying the case of schemes to $\varphi^*s$ we get
$$
\varphi^*[Z(s)]_k =
[Z(\varphi^*s)]_k =
\sum n_i[Z(s_{i, j})]_k
$$
by our remark on multiplicities above.
Combining all of the above the proof is complete.
\end{proof}

\noindent
The following lemma is a useful result in order to compute the intersection
product of the $c_1$ of an invertible sheaf and the cycle associated
to a closed subscheme.
Recall that $Z(s) \subset X$ denotes the zero scheme of a global section
$s$ of an invertible sheaf on a scheme $X$, see
Divisors, Definition \ref{divisors-definition-zero-scheme-s}.

\begin{lemma}
\label{lemma-geometric-cap}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let $Y \subset X$ be a closed subscheme with
$\dim_\delta(Y) \leq k + 1$ and let $s \in \Gamma(Y, \mathcal{L}|_Y)$
be a regular section. Then
$$
c_1(\mathcal{L}) \cap [Y]_{k + 1} = [Z(s)]_k
$$
in $A_k(X)$.
\end{lemma}

\begin{proof}
Write
$$
[Y]_{k + 1} = \sum n_i[Y_i]
$$
where $Y_i \subset Y$ are the irreducible components of
$Y$ of $\delta$-dimension $k + 1$ and $n_i > 0$.
By assumption the restriction
$s_i = s|_{Y_i} \in \Gamma(Y_i, \mathcal{L}|_{Y_i})$ is not
zero, and hence is a regular section. By Lemma \ref{lemma-compute-c1}
we see that $[Z(s_i)]_k$ represents $c_1(\mathcal{L}|_{Y_i})$.
Hence by definition
$$
c_1(\mathcal{L}) \cap [Y]_{k + 1} = \sum n_i[Z(s_i)]_k
$$
Thus the result follows from Lemma \ref{lemma-prepare-geometric-cap}.
\end{proof}









\section{Intersecting with an invertible sheaf and push and pull}
\label{section-intersecting-with-divisors-push-pull}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-intersecting-with-divisors-push-pull}.
In this section we prove that the operation $c_1(\mathcal{L}) \cap -$
commutes with flat pullback and proper pushforward.

\begin{lemma}
\label{lemma-prepare-flat-pullback-cap-c1}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
Let $\mathcal{L}$ be an invertible sheaf on $Y$.
Assume $Y$ is integral and $n = \dim_\delta(Y)$.
Let $s$ be a nonzero meromorphic section of $\mathcal{L}$.
Then we have
$$
f^*\text{div}_\mathcal{L}(s) = \sum n_i\text{div}_{f^*\mathcal{L}|_{X_i}}(s_i)
$$
in $Z_{n + r - 1}(X)$. Here the sum is over the irreducible
components $X_i \subset X$ of $\delta$-dimension $n + r$,
the section $s_i = f|_{X_i}^*(s)$ is the pullback of $s$, and
$n_i = m_{X_i, X}$ is the multiplicity of $X_i$ in $X$.
\end{lemma}

\begin{proof}
Using sleight of hand we will deduce this from
Lemma \ref{lemma-prepare-flat-pullback-rational-equivalence}.
(An alternative is to redo the proof of that lemma in the
setting of meromorphic sections of invertible modules.)
Namely, let $q : T \to Y$ be the morphism of
Lemma \ref{lemma-Gm-torsor} constructed using $\mathcal{L}$ on $Y$.
We will use all the properties of $T$ stated in this lemma.
Consider the fibre product diagram
$$
\xymatrix{
T' \ar[r]_{q'} \ar[d]_h & X \ar[d]^f \\
T \ar[r]^q & Y
}
$$
Then $q' : T' \to X$ is the morphism constructed using $f^*\mathcal{L}$
on $X$. Then it suffices to prove
$$
(q')^*f^*\text{div}_\mathcal{L}(s) =
\sum n_i (q')^*\text{div}_{f^*\mathcal{L}|_{X_i}}(s_i)
$$
Observe that $T'_i = q^{-1}(X_i)$ are the irreducible components of $T'$
and that $n_i$ is the multiplicity of $T'_i$ in $T'$.
The left hand side is equal to
$$
h^*q^*\text{div}_\mathcal{L}(s) = h^*\text{div}_T(q^*(s))
$$
by Lemma \ref{lemma-Gm-torsor-divisor-meromorphic-section}
(and Lemma \ref{lemma-compose-flat-pullback}).
On the other hand, denoting $q'_i : T'_i \to X_i$
the restriction of $q'$ we find that
Lemma \ref{lemma-Gm-torsor-divisor-meromorphic-section}
also tells us the right hand side is equal to
$$
\sum n_i \text{div}_{T_i}((q'_i)^*(s_i))
$$
In these two formulas the expressions $q^*(s)$ and $(q'_i)^*(s_i)$
represent the rational functions corresponding to the pulled back
meromorphic sections of $q^*\mathcal{L}$ and $(q'_i)^*f^*\mathcal{L}|_{X_i}$
via the isomorphism $\alpha : q^*\mathcal{L} \to \mathcal{O}_T$
and its pullbacks to spaces over $T$. With this convention it is
clear that $(q'_i)^*(s_i)$ is the composition of the rational function
$q^*(s)$ on $T$ and the morphism $h|_{T'_i} : T'_i \to T$.
Thus Lemma \ref{lemma-prepare-flat-pullback-rational-equivalence}
exactly says that
$$
h^*\text{div}_T(q^*(s)) = \sum n_i \text{div}_{T_i}((q'_i)^*(s_i))
$$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-flat-pullback-cap-c1}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
Let $\mathcal{L}$ be an invertible sheaf on $Y$.
Let $\alpha$ be a $k$-cycle on $Y$.
Then
$$
f^*(c_1(\mathcal{L}) \cap \alpha) = c_1(f^*\mathcal{L}) \cap f^*\alpha
$$
in $A_{k + r - 1}(X)$.
\end{lemma}

\begin{proof}
Write $\alpha = \sum n_i[W_i]$. We will show that
$$
f^*(c_1(\mathcal{L}) \cap [W_i]) = c_1(f^*\mathcal{L}) \cap f^*[W_i]
$$
in $A_{k + r - 1}(X)$ by producing a rational equivalence
on the closed subspace $f^{-1}(W_i)$ of $X$.
By the discussion in
Remark \ref{remark-infinite-sums-rational-equivalences}
this will prove the equality of the lemma is true.

\medskip\noindent
Let $W \subset Y$ be an integral closed subspace of $\delta$-dimension $k$.
Consider the closed subspace $W' = f^{-1}(W) = W \times_Y X$
so that we have the fibre product diagram
$$
\xymatrix{
W' \ar[r] \ar[d]_h & X \ar[d]^f \\
W \ar[r] & Y
}
$$
We have to show that
$f^*(c_1(\mathcal{L}) \cap [W]) = c_1(f^*\mathcal{L}) \cap f^*[W]$.
Choose a nonzero meromorphic section $s$ of $\mathcal{L}|_W$.
Let $W'_i \subset W'$ be the irreducible components of
$\delta$-dimension $k + r$. Write $[W']_{k + r} = \sum n_i[W'_i]$
with $n_i$ the multiplicity of $W'_i$ in $W'$ as per definition.
So $f^*[W] = \sum n_i[W'_i]$ in $Z_{k + r}(X)$.
Since each $W'_i \to W$ is dominant we
see that $s_i = s|_{W'_i}$ is a nonzero meromorphic section for
each $i$. By Lemma \ref{lemma-prepare-flat-pullback-cap-c1}
we have the following equality of cycles
$$
h^*\text{div}_{\mathcal{L}|_W}(s) =
\sum n_i\text{div}_{f^*\mathcal{L}|_{W'_i}}(s_i)
$$
in $Z_{k + r - 1}(W')$. This finishes the proof since
the left hand side is a cycle on $W'$ which pushes to
$f^*(c_1(\mathcal{L}) \cap [W])$ in $A_{k + r - 1}(X)$
and the right hand side is a cycle on $W'$ which pushes to
$c_1(f^*\mathcal{L}) \cap f^*[W]$ in $A_{k + r - 1}(X)$.
\end{proof}

\begin{lemma}
\label{lemma-equal-c1-as-cycles}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a proper morphism.
Let $\mathcal{L}$ be an invertible sheaf on $Y$.
Assume $X$, $Y$ integral, $f$ dominant, and $\dim_\delta(X) = \dim_\delta(Y)$.
Let $s$ be a nonzero meromorphic section $s$ of $\mathcal{L}$ on $Y$.
Then
$$
f_*\left(\text{div}_{f^*\mathcal{L}}(f^*s)\right) =
[R(X) : R(Y)]\text{div}_\mathcal{L}(s).
$$
as cycles on $Y$. In particular
$$
f_*(c_1(f^*\mathcal{L}) \cap [X]) = c_1(\mathcal{L}) \cap f_*[Y].
$$
\end{lemma}

\begin{proof}
The last equation follows from the first since $f_*[X] = [R(X) : R(Y)][Y]$ by
definition. Proof of the first equaltion. Let $q : T \to Y$ be the morphism of
Lemma \ref{lemma-Gm-torsor} constructed using $\mathcal{L}$ on $Y$. We will use
all the properties of $T$ stated in this lemma. Consider the fibre product
diagram
$$
\xymatrix{
T' \ar[r]_{q'} \ar[d]_h & X \ar[d]^f \\
T \ar[r]^q & Y
}
$$
Then $q' : T' \to X$ is the morphism constructed using $f^*\mathcal{L}$
on $X$. It suffices to prove the equality after pulling back to $T'$.
The left hand side pulls back to
\begin{align*}
q^*f_*\left(\text{div}_{f^*\mathcal{L}}(f^*s)\right)
& =
h_*(q')^*\text{div}_{f^*\mathcal{L}}(f^*s) \\
& =
h_*\text{div}_{(q')^*f^*\mathcal{L}}((q')^*f^*s) \\
& =
h_*\text{div}_{h^*q^*\mathcal{L}}(h^*q^*s)
\end{align*}
The first equality by Lemma \ref{lemma-flat-pullback-proper-pushforward}.
The second by Lemma \ref{lemma-prepare-flat-pullback-cap-c1}
using that $T'$ is integral. The third because the displayed diagram commutes.
The right hand side pulls back to
$$
[R(X) : R(Y)]q^*\text{div}_\mathcal{L}(s) =
[R(T') : R(T)]\text{div}_{q^*\mathcal{L}}(q^*s)
$$
This follows from Lemma \ref{lemma-prepare-flat-pullback-cap-c1},
the fact that $T$ is integral, and the equality
$[R(T') : R(T)] = [R(X) : R(Y)]$ whose proof we omit
(it follows from Lemma \ref{lemma-flat-pullback-proper-pushforward}
but that would be a silly way to prove the equality).
Thus it suffices to prove the lemma for $h : T' \to T$, the
invertible module $q^\mathcal{L}$ and the section $q^*s$.
Since $q^*\mathcal{L} = \mathcal{O}_T$
we reduce to the case where $\mathcal{L} \cong \mathcal{O}$
discussed in the next paragraph.

\medskip\noindent
Assume that $\mathcal{L} = \mathcal{O}_Y$. In this case $s$
corresponds to a rational function $g \in R(Y)$. Using the
embedding $R(Y) \subset R(X)$ we may think of $g$ as a rational
on $X$ and we are simply trying to prove
$$
f_*\left(\text{div}_X(g)\right) = [R(X) : R(Y)]\text{div}_Y(g).
$$
Comparing with the result of Lemma \ref{lemma-proper-pushforward-alteration}
we see this true since $\text{Nm}_{R(X)/R(Y)}(g) = g^{[R(X) : R(Y)]}$
as $g \in R(Y)^*$.
\end{proof}

\begin{lemma}
\label{lemma-pushforward-cap-c1}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $p : X \to Y$ be a proper morphism.
Let $\alpha \in Z_{k + 1}(X)$.
Let $\mathcal{L}$ be an invertible sheaf on $Y$.
Then
$$
p_*(c_1(p^*\mathcal{L}) \cap \alpha) = c_1(\mathcal{L}) \cap p_*\alpha
$$
in $A_k(Y)$.
\end{lemma}

\begin{proof}
Suppose that $p$ has the property that for every integral
closed subspace $W \subset X$ the map $p|_W : W \to Y$
is a closed immersion. Then, by definition of capping
with $c_1(\mathcal{L})$ the lemma holds.

\medskip\noindent
We will use this remark to reduce to a special case. Namely,
write $\alpha = \sum n_i[W_i]$ with $n_i \not = 0$ and $W_i$ pairwise
distinct. Let $W'_i \subset Y$ be the ``image'' of $W_i$ as
in Lemma \ref{lemma-proper-image}. Consider the diagram
$$
\xymatrix{
X' = \coprod W_i \ar[r]_-q \ar[d]_{p'} & X \ar[d]^p \\
Y' = \coprod W'_i \ar[r]^-{q'} & Y.
}
$$
Since $\{W_i\}$ is locally finite on $X$, and $p$ is proper
we see that $\{W'_i\}$ is locally finite on $Y$ and that
$q, q', p'$ are also proper morphisms.
We may think of $\sum n_i[W_i]$ also as a $k$-cycle
$\alpha' \in Z_k(X')$. Clearly $q_*\alpha' = \alpha$.
We have
$q_*(c_1(q^*p^*\mathcal{L}) \cap \alpha')
= c_1(p^*\mathcal{L}) \cap q_*\alpha'$
and
$(q')_*(c_1((q')^*\mathcal{L}) \cap p'_*\alpha') =
c_1(\mathcal{L}) \cap q'_*p'_*\alpha'$ by the initial
remark of the proof. Hence it suffices to prove the lemma
for the morphism $p'$ and the cycle $\sum n_i[W_i]$.
Clearly, this means we may assume $X$, $Y$ integral,
$f : X \to Y$ dominant and $\alpha = [X]$.
In this case the result follows from
Lemma \ref{lemma-equal-c1-as-cycles}.
\end{proof}













\section{The key formula}
\label{section-key}

\noindent
This section is the analogue of Chow Homology, Section \ref{chow-section-key}.
We strongly urge the reader to read the proof in that case first.

\medskip\noindent
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is integral
and $\dim_\delta(X) = n$. Let $\mathcal{L}$ and $\mathcal{N}$ be invertible
$\mathcal{O}_X$-modules. Let $s$ be a nonzero meromorphic section of
$\mathcal{L}$ and let $t$ be a nonzero meromorphic section of $\mathcal{N}$.
Let $Z \subset X$ be a prime divisor with generic point $\xi \in |Z|$.
Consider the morphism
$$
c_\xi : \Spec(\mathcal{O}_{X, \xi}^h) \longrightarrow X
$$
used in Spaces over Fields, Section \ref{spaces-over-fields-section-c1}.
We denote $\mathcal{L}_\xi$ and $\mathcal{N}_\xi$ the pullbacks
of $\mathcal{L}$ and $\mathcal{N}$ by $c_\xi$; we often think of
$\mathcal{L}_\xi$ and $\mathcal{N}_\xi$ as the rank $1$ free
$\mathcal{O}_{X, \xi}^h$-modules they give rise to.
Note that the pullback of $s$, resp.\ $t$ is a regular meromorphic
section of $\mathcal{L}_\xi$, resp.\ $\mathcal{N}_\xi$.

\medskip\noindent
Let $Z_i \subset X$, $i \in I$ be a locally finite set of prime divisors
with the following property: If $Z \not \in \{Z_i\}$, then $s$ is a
generator for $\mathcal{L}_\xi$ and $t$ is a generator for $\mathcal{N}_\xi$.
Such a set exists by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-divisor-meromorphic-locally-finite}.
Then
$$
\text{div}_\mathcal{L}(s) = \sum \text{ord}_{Z_i, \mathcal{L}}(s) [Z_i]
$$
and similarly
$$
\text{div}_\mathcal{N}(t) = \sum \text{ord}_{Z_i, \mathcal{N}}(t) [Z_i]
$$
Unwinding the definitions more, we pick for each $i$ generators
$s_i \in \mathcal{L}_{\xi_i}$ and $t_i \in \mathcal{N}_{\xi_i}$
where $\xi_i$ is the generic point of $Z_i$. Then we can write
$$
s = f_i s_i
\quad\text{and}\quad
t = g_i t_i
$$
with $f_i, g_i$ invertible elements of the total ring of fractions
$Q(\mathcal{O}_{X, \xi_i}^h)$. We abbreviate $B_i = \mathcal{O}_{X, \xi_i}^h$.
Let us denote
$$
\text{ord}_{B_i} : Q(B_i)^* \longrightarrow \mathbf{Z},\quad
a/b \longmapsto
\text{length}_{B_i}(B_i/aB_i) - \text{length}_{B_i}(B_i/bB_i)
$$
In other words, we temporarily extend
Algebra, Definition \ref{algebra-definition-ord}
to these reduced Noetherian local rings of dimension $1$.
Then by definition
$$
\text{ord}_{Z_i, \mathcal{L}}(s) = \text{ord}_{B_i}(f_i)
\quad\text{and}\quad
\text{ord}_{Z_i, \mathcal{N}}(t) = \text{ord}_{B_i}(g_i)
$$
Since $\xi_i$ is the generic point of $Z_i$ we see that
the residue field $\kappa(\xi_i)$ is the function field of $Z_i$.
Moreover $\kappa(\xi_i)$ is the residue field of $B_i$, see
Decent Spaces, Lemma
\ref{decent-spaces-lemma-residue-field-henselian-local-ring}.
Since $t_i$ is a generator of $\mathcal{N}_{\xi_i}$ we see that
its image in the fibre $\mathcal{N}_{\xi_i} \otimes_{B_i} \kappa(\xi_i)$
is a nonzero meromorphic section of $\mathcal{N}|_{Z_i}$. We will denote
this image $t_i|_{Z_i}$. From our definitions it follows that
$$
c_1(\mathcal{N}) \cap \text{div}_\mathcal{L}(s) =
\sum \text{ord}_{B_i}(f_i)
(Z_i \to X)_*\text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i})
$$
and similarly
$$
c_1(\mathcal{L}) \cap \text{div}_\mathcal{N}(t) =
\sum \text{ord}_{B_i}(g_i)
(Z_i \to X)_*\text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i})
$$
in $A_{n - 2}(X)$. We are going to find a rational equivalence between
these two cycles. To do this we consider the tame symbol
$$
\partial_{B_i}(f_i, g_i) \in \kappa(\xi_i)^* = R(Z_i)^*
$$
see Chow Homology, Section \ref{chow-section-tame-symbol}.

\begin{lemma}[Key formula]
\label{lemma-key-formula}
In the situation above the cycle
$$
\sum
(Z_i \to X)_*\left(
\text{ord}_{B_i}(f_i) \text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i}) -
\text{ord}_{B_i}(g_i) \text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i}) \right)
$$
is equal to the cycle
$$
\sum (Z_i \to X)_*\text{div}(\partial_{B_i}(f_i, g_i))
$$
\end{lemma}

\begin{proof}
The strategy of the proof will be: first reduce to the case where
$\mathcal{L}$ and $\mathcal{N}$ are trivial invertible modules,
then change our choices of local trivializations, and then finally
use \'etale localization to reduce to the case of schemes\footnote{It
is possible that a shorter proof can be given by immediately
applying \'etale localization.}.

\medskip\noindent
First step. Let $q : T \to X$ be the morphism constructed in
Lemma \ref{lemma-Gm-torsor}. We will use all properties stated in
that lemma without further mention. In particular, it suffices to
show that the cycles are equal after pulling back by $q$.
Denote $s'$ and $t'$ the pullbacks of $s$ and $t$ to meromorphic sections
of $q^*\mathcal{L}$ and $q^*\mathcal{N}$.
Denote $Z'_i = q^{-1}(Z_i)$, denote $\xi'_i \in |Z'_i|$ the generic point,
denote $B'_i = \mathcal{O}_{T, \xi'_i}^h$, denote
$\mathcal{L}_{\xi'_i}$ and $\mathcal{N}_{\xi'_i}$ the pullbacks
of $\mathcal{L}$ and $\mathcal{N}$ to $\Spec(B'_i)$.
Recall that we have commutative diagrams
$$
\xymatrix{
\Spec(B'_i) \ar[r]_-{c_{\xi'_i}} \ar[d] & T \ar[d]^q \\
\Spec(B_i) \ar[r]^-{c_{\xi_i}} & X
}
$$
see Decent Spaces, Remark
\ref{decent-spaces-remark-functoriality-henselian-local-ring}.
Denote $s'_i$ and $t'_i$ the pullbacks of $s_i$ and $t_i$ which
are generators of $\mathcal{L}_{\xi'_i}$ and $\mathcal{N}_{\xi'_i}$.
Then we have
$$
s' = f'_i s'_i
\quad\text{and}\quad
t' = g'_i t'_i
$$
where $f'_i$ and $g'_i$ are the images of $f_i, g_i$
under the map $Q(B_i) \to Q(B'_i)$ induced by $B_i \to B'_i$.
By Algebra, Lemma \ref{algebra-lemma-pullback-module} we have
$$
\text{ord}_{B_i}(f_i) = \text{ord}_{B'_i}(f'_i)
\quad\text{and}\quad
\text{ord}_{B_i}(g_i) = \text{ord}_{B'_i}(g'_i)
$$
By Lemma \ref{lemma-prepare-flat-pullback-cap-c1} applied
to $q : Z'_i \to Z_i$ we have
$$
q^*\text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i}) =
\text{div}_{q^*\mathcal{N}|_{Z'_i}}(t'_i|_{Z'_i})
\quad\text{and}\quad
q^*\text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i}) =
\text{div}_{q^*\mathcal{L}|_{Z'_i}}(s'_i|_{Z'_i})
$$
This already shows that the first cycle in the statement of the
lemma pulls back to the corresponding cycle for
$s', t', Z'_i, s'_i, t'_i$. To see the same is true for the
second, note that by
Chow Homology, Lemma \ref{chow-lemma-tame-symbol-formally-smooth} we have
$$
\partial_{B_i}(f_i, g_i) \mapsto
\partial_{B'_i}(f'_i, g'_i)
\quad\text{via}\quad
\kappa(\xi_i) \to \kappa(\xi'_i)
$$
Hence the same lemma as before shows that
$$
q^*\text{div}(\partial_{B_i}(f_i, g_i)) =
\text{div}(\partial_{B'_i}(f'_i, g'_i))
$$
Since $q^*\mathcal{L} \cong \mathcal{O}_T$ we find that it suffices
to prove the equality in case $\mathcal{L}$ is trivial.
Exchanging the roles of $\mathcal{L}$ and $\mathcal{N}$ we
see that we may similarly assume $\mathcal{N}$ is trivial.
This finishes the proof of the first step.

\medskip\noindent
Second step. Assume $\mathcal{L} = \mathcal{O}_X$ and
$\mathcal{N} = \mathcal{O}_X$. Denote $1$ the trivializing
section of $\mathcal{L}$. Then $s_i = u \cdot 1$
for some unit $u \in B_i$. Let us examine what happens
if we replace $s_i$ by $1$. Then $f_i$ gets replaced by $u f_i$.
Thus the first part of the first expression of the lemma is unchanged
and in the second part we add
$$
\text{ord}_{B_i}(g_i)\text{div}(u|_{Z_i})
$$
where $u|_{Z_i}$ is the image of $u$ in the residue field by
Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-divisor-meromorphic-well-defined}
and in the second expression we add
$$
\text{div}(\partial_{B_i}(u, g_i))
$$
by bi-linearity of the tame symbol. These terms agree by the property
of the tame symbol given in
Chow Homology, Equation (\ref{chow-item-normalization}).

\medskip\noindent
Let $Y \subset X$ be an integral closed subspace with $\dim_\delta(Y) = n - 2$.
To show that the coefficients of $Y$ of the two cycles of the lemma
is the same, we may do a replacement of $s_i$ by $1$ as in the previous
paragraph. In exactly the same way one shows that we may do a replacement
of $t_i$ by $1$. Since there are only a finite number of $Z_i$
such that $Y \subset Z_i$ we may assume $s_i = 1$ and $t_i = 1$
for all these $Z_i$.

\medskip\noindent
Third step. Here we prove the coefficients of $Y$ in the cycles
of the lemma agree for an integral closed subspace $Y$ with
$\dim_\delta(Y) = n - 2$ such that moreover
$\mathcal{L} = \mathcal{O}_X$ and $\mathcal{N} = \mathcal{O}_X$
and $s_i = 1$ and $t_i = 1$ for all $Z_i$ such that $Y \subset Z_i$.
After replacing $X$ by a smaller open subspace we may
in fact assume that $s_i$ and $t_i$ are equal to $1$ for all $i$.
In this case the first cycle is zero. Our task is to show that
the coefficient of $Y$ in the second cycle is zero as well.

\medskip\noindent
First, since $\mathcal{L} = \mathcal{O}_X$ and $\mathcal{N} = \mathcal{O}_X$
we may and do think of $s, t$ as rational functions $f, g$ on $X$.
Since $s_i$ and $t_i$ are equal to $1$ we find that $f_i$, resp.\ $g_i$
is the image of $f$, resp.\ $g$ in $Q(B_i)$ for all $i$.
Let $\zeta \in |Y|$ be the generic point. Choose an
\'etale neighbourhood
$$
(U, u) \longrightarrow (X, \zeta)
$$
and denote $Y' = \overline{\{u\}} \subset U$.
Since an \'etale morphism is flat, we can pullback $f$ and $g$
to regular meromorphic functions on $U$ which we will also denote
$f$ and $g$.
For every prime divisor $Y \subset Z \subset X$ the scheme $Z \times_X U$
is a union of prime divisors of $U$. Conversely, given a prime divisor
$Y' \subset Z' \subset U$, there is a prime divisor
$Y \subset Z \subset X$ such that $Z'$ is a component of $Z \times_X U$.
Given such a pair $(Z, Z')$ the ring map
$$
\mathcal{O}_{X, \xi}^h \to \mathcal{O}_{U, \xi'}^h
$$
is \'etale (in fact it is finite \'etale). Hence we find that
$$
\partial_{\mathcal{O}_{X, \xi}^h}(f, g) \mapsto
\partial_{\mathcal{O}_{U, \xi'}^h}(f, g)
\quad\text{via}\quad
\kappa(\xi) \to \kappa(\xi')
$$
by Chow Homology, Lemma \ref{chow-lemma-tame-symbol-formally-smooth}.
Thus Lemma \ref{lemma-etale-pullback-principal-divisor} applies to show
$$
(Z \times_X U \to Z)^*\text{div}_Z(\partial_{\mathcal{O}_{X, \xi}^h}(f, g))
=
\sum\nolimits_{Z' \subset Z \times_X U}
\text{div}_{Z'}(\partial_{\mathcal{O}_{U, \xi'}^h}(f, g))
$$
Since flat pullback commutes with pushforward along closed
immersions (Lemma \ref{lemma-flat-pullback-proper-pushforward})
we see that it suffices to prove that the coefficient
of $Y'$ in
$$
\sum\nolimits_{Z' \subset U} 
(Z' \to U)_*\text{div}_{Z'}(\partial_{\mathcal{O}_{U, \xi'}^h}(f, g))
$$
is zero.

\medskip\noindent
Let $A = \mathcal{O}_{U, u}$. Then $f, g \in Q(A)^*$.
Thus we can write $f = a/b$ and $g = c/d$ with
$a, b, c, d \in A$ nonzerodivisors.
The coefficient of $Y'$ in the expression above is
$$
\sum\nolimits_{\mathfrak q \subset A\text{ height }1}
\text{ord}_{A/\mathfrak q}(\partial_{A_\mathfrak q}(f, g))
$$
By bilinearity of $\partial_A$ it suffices to prove
$$
\sum\nolimits_{\mathfrak q \subset A\text{ height }1}
\text{ord}_{A/\mathfrak q}(\partial_{A_\mathfrak q}(a, c))
$$
is zero and similarly for the other pairs $(a, d)$, $(b, c)$, and
$(b, d)$. This is true by
Chow Homology, Lemma \ref{chow-lemma-key-nonzerodivisors}.
\end{proof}











\section{Intersecting with an invertible sheaf and rational equivalence}
\label{section-commutativity}

\noindent
This section is the analogue of Chow Homology, Section
\ref{chow-section-commutativity}.
Applying the key lemma we obtain the fundamental properties of intersecting
with invertible sheaves. In particular, we will see that
$c_1(\mathcal{L}) \cap -$ factors through rational equivalence and
that these operations for different invertible sheaves commute.

\begin{lemma}
\label{lemma-commutativity-on-integral}
In Situation \ref{situation-setup} let $X/B$ be good.
Assume $X$ integral and $\dim_\delta(X) = n$.
Let $\mathcal{L}$, $\mathcal{N}$ be invertible on $X$.
Choose a nonzero meromorphic section $s$ of $\mathcal{L}$
and a nonzero meromorphic section $t$ of $\mathcal{N}$.
Set $\alpha = \text{div}_\mathcal{L}(s)$ and
$\beta = \text{div}_\mathcal{N}(t)$.
Then
$$
c_1(\mathcal{N}) \cap \alpha
=
c_1(\mathcal{L}) \cap \beta
$$
in $A_{n - 2}(X)$.
\end{lemma}

\begin{proof}
Immediate from the key Lemma \ref{lemma-key-formula}
and the discussion preceding it.
\end{proof}

\begin{lemma}
\label{lemma-factors}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be invertible on $X$.
The operation $\alpha \mapsto c_1(\mathcal{L}) \cap \alpha$
factors through rational equivalence to give an operation
$$
c_1(\mathcal{L}) \cap - : A_{k + 1}(X) \to A_k(X)
$$
\end{lemma}

\begin{proof}
Let $\alpha \in Z_{k + 1}(X)$, and $\alpha \sim_{rat} 0$.
We have to show that $c_1(\mathcal{L}) \cap \alpha$
as defined in Definition \ref{definition-cap-c1} is zero.
By Definition \ref{definition-rational-equivalence} there
exists a locally finite family $\{W_j\}$ of integral closed
subspaces with $\dim_\delta(W_j) = k + 2$ and rational functions
$f_j \in R(W_j)^*$ such that
$$
\alpha = \sum (i_j)_*\text{div}_{W_j}(f_j)
$$
Note that $p : \coprod W_j \to X$ is a proper morphism,
and hence $\alpha = p_*\alpha'$ where $\alpha' \in Z_{k + 1}(\coprod W_j)$
is the sum of the principal divisors $\text{div}_{W_j}(f_j)$.
By Lemma \ref{lemma-pushforward-cap-c1} we have
$c_1(\mathcal{L}) \cap \alpha = p_*(c_1(p^*\mathcal{L}) \cap \alpha')$.
Hence it suffices to show that each
$c_1(\mathcal{L}|_{W_j}) \cap \text{div}_{W_j}(f_j)$ is zero.
In other words we may assume that $X$ is integral and
$\alpha = \text{div}_X(f)$ for some $f \in R(X)^*$.

\medskip\noindent
Assume $X$ is integral and $\alpha = \text{div}_X(f)$ for some $f \in R(X)^*$.
We can think of $f$ as a regular meromorphic section of the invertible
sheaf $\mathcal{N} = \mathcal{O}_X$. Choose a meromorphic section
$s$ of $\mathcal{L}$ and denote $\beta = \text{div}_\mathcal{L}(s)$.
By Lemma \ref{lemma-commutativity-on-integral}
we conclude that
$$
c_1(\mathcal{L}) \cap \alpha = c_1(\mathcal{O}_X) \cap \beta.
$$
However, by Lemma \ref{lemma-c1-cap-additive} we see that the right hand side
is zero in $A_k(X)$ as desired.
\end{proof}

\noindent
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be invertible on $X$.
We will denote
$$
c_1(\mathcal{L})^s \cap - : A_{k + s}(X) \to A_k(X)
$$
the operation $c_1(\mathcal{L}) \cap - $. This makes sense by
Lemma \ref{lemma-factors}. We will denote $c_1(\mathcal{L}^s \cap -$
the $s$-fold iterate of this operation for all $s \geq 0$.

\begin{lemma}
\label{lemma-cap-commutative}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$, $\mathcal{N}$ be invertible on $X$.
For any $\alpha \in A_{k + 2}(X)$ we have
$$
c_1(\mathcal{L}) \cap c_1(\mathcal{N}) \cap \alpha
=
c_1(\mathcal{N}) \cap c_1(\mathcal{L}) \cap \alpha
$$
as elements of $A_k(X)$.
\end{lemma}

\begin{proof}
Write $\alpha = \sum m_j[Z_j]$ for some locally finite
collection of integral closed subspaces $Z_j \subset X$
with $\dim_\delta(Z_j) = k + 2$.
Consider the proper morphism $p : \coprod Z_j \to X$.
Set $\alpha' = \sum m_j[Z_j]$ as a $(k + 2)$-cycle on
$\coprod Z_j$. By several applications of
Lemma \ref{lemma-pushforward-cap-c1} we see that
$c_1(\mathcal{L}) \cap c_1(\mathcal{N}) \cap \alpha
= p_*(c_1(p^*\mathcal{L}) \cap c_1(p^*\mathcal{N}) \cap \alpha')$
and
$c_1(\mathcal{N}) \cap c_1(\mathcal{L}) \cap \alpha
= p_*(c_1(p^*\mathcal{N}) \cap c_1(p^*\mathcal{L}) \cap \alpha')$.
Hence it suffices to prove the formula in case $X$ is integral
and $\alpha = [X]$. In this case the result follows
from Lemma \ref{lemma-commutativity-on-integral} and the definitions.
\end{proof}

















\section{Intersecting with effective Cartier divisors}
\label{section-intersecting-effective-Cartier}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-intersecting-effective-Cartier}.
Please read the introduction of that section we motivation.

\medskip\noindent
Recall that effective Cartier divisors correspond $1$-to-$1$ to
isomorphism classes of pairs $(\mathcal{L}, s)$ where $\mathcal{L}$
is an invertible sheaf and $s$ is a global section, see
Divisors on Spaces, Lemma \ref{spaces-divisors-lemma-characterize-OD}.
If $D$ corresponds to $(\mathcal{L}, s)$, then
$\mathcal{L} = \mathcal{O}_X(D)$. Please keep this in mind while
reading this section.

\begin{definition}
\label{definition-gysin-homomorphism}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s)$ be a pair consisting of an invertible
sheaf and a global section $s \in \Gamma(X, \mathcal{L})$.
Let $D = Z(s)$ be the vanishing locus of $s$, and
denote $i : D \to X$ the closed immersion.
We define, for every integer $k$, a (refined) {\it Gysin homomorphism}
$$
i^* : Z_{k + 1}(X) \to A_k(D).
$$
by the following rules:
\begin{enumerate}
\item Given a integral closed subspace $W \subset X$ with
$\dim_\delta(W) = k + 1$ we define
\begin{enumerate}
\item if $W \not \subset D$, then $i^*[W] = [D \cap W]_k$ as a
$k$-cycle on $D$, and
\item if $W \subset D$, then
$i^*[W] = i'_*(c_1(\mathcal{L}|_W) \cap [W])$,
where $i' : W \to D$ is the induced closed immersion.
\end{enumerate}
\item For a general $(k + 1)$-cycle $\alpha = \sum n_j[W_j]$
we set
$$
i^*\alpha = \sum n_j i^*[W_j]
$$
\item If $D$ is an effective Cartier divisor, then we denote
$D \cdot \alpha = i_*i^*\alpha$ the pushforward of
the class to a class on $X$.
\end{enumerate}
\end{definition}

\noindent
In fact, as we will see later, this Gysin homomorphism $i^*$ can be viewed
as an example of a non-flat pullback. Thus we will sometimes informally
call the class $i^*\alpha$ the {\it pullback} of the class $\alpha$.

\begin{remark}
\label{remark-on-cycles}
Let $S$, $B$, $X$, $\mathcal{L}$, $s$, $i : D \to X$ be as in
Definition \ref{definition-gysin-homomorphism} and assume
that $\mathcal{L}|_D \cong \mathcal{O}_D$. In this case we
can define a canonical map $i^* : Z_{k + 1}(X) \to Z_k(D)$
on cycles, by requiring that $i^*[W] = 0$ whenever $W \subset D$.
The possibility to do this will be useful later on.
\end{remark}

\begin{remark}
\label{remark-pullback-pairs}
Let $f : X' \to X$ be a morphism of good algebraic spaces over $B$
as in Situation \ref{situation-setup}. Let $(\mathcal{L}, s, i : D \to X)$
be a triple as in Definition \ref{definition-gysin-homomorphism}.
Then we can set $\mathcal{L}' = f^*\mathcal{L}$, $s' = f^*s$, and
$D' = X' \times_X D = Z(s')$. This gives a commutative diagram
$$
\xymatrix{
D' \ar[d]_g \ar[r]_{i'} & X' \ar[d]^f \\
D \ar[r]^i & X
}
$$
and we can ask for various compatibilities between $i^*$ and $(i')^*$.
\end{remark}

\begin{lemma}
\label{lemma-support-cap-effective-Cartier}
In Situation \ref{situation-setup} let $X/B$ be good. Let
$(\mathcal{L}, s, i : D \to X)$ be as in
Definition \ref{definition-gysin-homomorphism}. Let $\alpha$ be a
$(k + 1)$-cycle on $X$. Then $i_*i^*\alpha = c_1(\mathcal{L}) \cap \alpha$
in $A_k(X)$. In particular, if $D$ is an effective Cartier divisor, then
$D \cdot \alpha = c_1(\mathcal{O}_X(D)) \cap \alpha$.
\end{lemma}

\begin{proof}
Write $\alpha = \sum n_j[W_j]$ where $i_j : W_j \to X$ are integral closed
subspaces with $\dim_\delta(W_j) = k$.
Since $D$ is the vanishing locus of $s$ we see that
$D \cap W_j$ is the vanishing locus
of the restriction $s|_{W_j}$. Hence for each $j$ such that
$W_j \not \subset D$ we have
$c_1(\mathcal{L}) \cap [W_j] = [D \cap W_j]_k$
by Lemma \ref{lemma-geometric-cap}. So we have
$$
c_1(\mathcal{L}) \cap \alpha
=
\sum\nolimits_{W_j \not \subset D} n_j[D \cap W_j]_k
+
\sum\nolimits_{W_j \subset D}
n_j i_{j, *}(c_1(\mathcal{L})|_{W_j}) \cap [W_j])
$$
in $A_k(X)$ by Definition \ref{definition-cap-c1}.
The right hand side matches (termwise) the pushforward of the class
$i^*\alpha$ on $D$ from Definition \ref{definition-gysin-homomorphism}.
Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-closed-in-X-gysin}
In Situation \ref{situation-setup}. Let $f : X' \to X$ be a proper morphism
of good algebraic spaces over $B$. Let $(\mathcal{L}, s, i : D \to X)$ be as in
Definition \ref{definition-gysin-homomorphism}.
Form the diagram
$$
\xymatrix{
D' \ar[d]_g \ar[r]_{i'} & X' \ar[d]^f \\
D \ar[r]^i & X
}
$$
as in Remark \ref{remark-pullback-pairs}.
For any $(k + 1)$-cycle $\alpha'$ on $X'$ we have
$i^*f_*\alpha' = g_*(i')^*\alpha'$ in $A_k(D)$
(this makes sense as $f_*$ is defined on the level of cycles).
\end{lemma}

\begin{proof}
Suppose $\alpha = [W']$ for some integral closed subspace
$W' \subset X'$. Let $W \subset X$ be the ``image'' of $W'$
as in Lemma \ref{lemma-proper-image}. In case $W' \not \subset D'$,
then $W \not \subset D$ and we see that
$$
[W' \cap D']_k = \text{div}_{\mathcal{L}'|_{W'}}({s'|_{W'}})
\quad\text{and}\quad
[W \cap D]_k = \text{div}_{\mathcal{L}|_W}(s|_W)
$$
and hence $f_*$ of the first cycle equals the second cycle by
Lemma \ref{lemma-equal-c1-as-cycles}. Hence the
equality holds as cycles. In case $W' \subset D'$, then
$W \subset D$ and $f_*(c_1(\mathcal{L}|_{W'}) \cap [W'])$
is equal to $c_1(\mathcal{L}|_W) \cap [W]$ in $A_k(W)$ by the second
assertion of Lemma \ref{lemma-equal-c1-as-cycles}.
By Remark \ref{remark-infinite-sums-rational-equivalences}
the result follows for general $\alpha'$.
\end{proof}

\begin{lemma}
\label{lemma-gysin-flat-pullback}
In Situation \ref{situation-setup}. Let $f : X' \to X$
be a flat morphism of relative dimension $r$ of
good algebraic spaces over $B$. Let $(\mathcal{L}, s, i : D \to X)$ be as in
Definition \ref{definition-gysin-homomorphism}. Form the diagram
$$
\xymatrix{
D' \ar[d]_g \ar[r]_{i'} & X' \ar[d]^f \\
D \ar[r]^i & X
}
$$
as in Remark \ref{remark-pullback-pairs}.
For any $(k + 1)$-cycle $\alpha$ on $X$ we have
$(i')^*f^*\alpha = g^*i^*\alpha'$ in $A_{k + r}(D)$
(this makes sense as $f^*$ is defined on the level of cycles).
\end{lemma}

\begin{proof}
Suppose $\alpha = [W]$ for some integral closed subspace
$W \subset X$. Let $W' = f^{-1}(W) \subset X'$. In case $W \not \subset D$,
then $W' \not \subset D'$ and we see that
$$
W' \cap D' = g^{-1}(W \cap D)
$$
as closed subspaces of $D'$. Hence the
equality holds as cycles, see Lemma \ref{lemma-pullback-coherent}.
In case $W \subset D$, then $W' \subset D'$ and $W' = g^{-1}(W)$
with $[W']_{k + 1 + r} = g^*[W]$ and equality holds in
$A_{k + r}(D')$ by Lemma \ref{lemma-flat-pullback-cap-c1}.
By Remark \ref{remark-infinite-sums-rational-equivalences}
the result follows for general $\alpha'$.
\end{proof}

\begin{lemma}
\label{lemma-easy-gysin}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s, i : D \to X)$ be as in
Definition \ref{definition-gysin-homomorphism}.
Let $Z \subset X$ be a closed subscheme such
that $\dim_\delta(Z) \leq k + 1$ and such that
$D \cap Z$ is an effective Cartier divisor on $Z$. Then
$i^*([Z]_{k + 1}) = [D \cap Z]_k$.
\end{lemma}

\begin{proof}
The assumption means that $s|_Z$ is a regular section of $\mathcal{L}|_Z$.
Thus $D \cap Z = Z(s)$ and we get
$$
[D \cap Z]_k = \sum n_i [Z(s_i)]_k
$$
as cycles where $s_i = s|_{Z_i}$, the $Z_i$ are the irreducible components
of $\delta$-dimension $k + 1$, and $[Z]_{k + 1} = \sum n_i[Z_i]$.
See Lemma \ref{lemma-prepare-geometric-cap}.
We have $D \cap Z_i = Z(s_i)$. Comparing with the definition
of the gysin map we conclude.
\end{proof}













\section{Gysin homomorphisms}
\label{section-gysin}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-gysin}.
In this section we use the key formula to show the Gysin homomorphism
factor through rational equivalence.

\begin{lemma}
\label{lemma-gysin-factors-general}
In Situation \ref{situation-setup} let $X/B$ be good.
Assume $X$ integral and $n = \dim_\delta(X)$.
Let $i : D \to X$ be an effective Cartier divisor.
Let $\mathcal{N}$ be an invertible $\mathcal{O}_X$-module
and let $t$ be a nonzero meromorphic section of $\mathcal{N}$.
Then $i^*\text{div}_\mathcal{N}(t) = c_1(\mathcal{N}) \cap [D]_{n - 1}$
in $A_{n - 2}(D)$.
\end{lemma}

\begin{proof}
Write $\text{div}_\mathcal{N}(t) = \sum \text{ord}_{Z_i, \mathcal{N}}(t)[Z_i]$
for some integral closed subspaces $Z_i \subset X$ of $\delta$-dimension
$n - 1$. We may assume that the family $\{Z_i\}$ is locally
finite, that $t \in \Gamma(U, \mathcal{N}|_U)$ is a generator
where $U = X \setminus \bigcup Z_i$, and that every irreducible component
of $D$ is one of the $Z_i$, see
Spaces over Fields, Lemmas
\ref{spaces-over-fields-lemma-components-locally-finite},
\ref{spaces-over-fields-lemma-divisor-locally-finite}, and
\ref{spaces-over-fields-lemma-divisor-meromorphic-locally-finite}.

\medskip\noindent
Set $\mathcal{L} = \mathcal{O}_X(D)$. Denote
$s \in \Gamma(X, \mathcal{O}_X(D)) = \Gamma(X, \mathcal{L})$
the canonical section. We will apply the discussion of
Section \ref{section-key} to our current situation.
For each $i$ let $\xi_i \in |Z_i|$ be its generic point. Let
$B_i = \mathcal{O}_{X, \xi_i}^h$. For each $i$ we pick generators
$s_i$ of $\mathcal{L}_{\xi_i}$ and $t_i$ of $\mathcal{N}_{\xi_i}$
over $B_i$ but we insist that we pick $s_i = s$ if $Z_i \not \subset D$.
Write $s = f_i s_i$ and $t = g_i t_i$ with $f_i, g_i \in B_i$.
Then $\text{ord}_{Z_i, \mathcal{N}}(t) = \text{ord}_{B_i}(g_i)$.
On the other hand, we have $f_i \in B_i$ and
$$
[D]_{n - 1} = \sum \text{ord}_{B_i}(f_i)[Z_i]
$$
because of our choices of $s_i$. We claim that
$$
i^*\text{div}_\mathcal{N}(t) =
\sum \text{ord}_{B_i}(g_i) \text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i})
$$
as cycles. More precisely, the right hand side is a cycle
representing the left hand side. Namely, this is clear by our
formula for $\text{div}_\mathcal{N}(t)$ and the fact that
$\text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i}) = [Z(s_i|_{Z_i})]_{n - 2} =
[Z_i \cap D]_{n - 2}$ when $Z_i \not \subset D$ because in
that case $s_i|_{Z_i} = s|_{Z_i}$ is a regular section, see
Lemma \ref{lemma-compute-c1}. Similarly,
$$
c_1(\mathcal{N}) \cap [D]_{n - 1} =
\sum \text{ord}_{B_i}(f_i) \text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i})
$$
The key formula (Lemma \ref{lemma-key-formula}) gives the equality
$$
\sum \left(
\text{ord}_{B_i}(f_i) \text{div}_{\mathcal{N}|_{Z_i}}(t_i|_{Z_i}) -
\text{ord}_{B_i}(g_i) \text{div}_{\mathcal{L}|_{Z_i}}(s_i|_{Z_i}) \right) =
\sum \text{div}_{Z_i}(\partial_{B_i}(f_i, g_i))
$$
of cycles. If $Z_i \not \subset D$, then $f_i = 1$ and hence
$\text{div}_{Z_i}(\partial_{B_i}(f_i, g_i)) = 0$. Thus we get a rational
equivalence between our specific cycles representing
$i^*\text{div}_\mathcal{N}(t)$ and $c_1(\mathcal{N}) \cap [D]_{n - 1}$
on $D$. This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-gysin-factors}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s, i : D \to X)$ be as in
Definition \ref{definition-gysin-homomorphism}.
The Gysin homomorphism factors through rational equivalence to
give a map $i^* : A_{k + 1}(X) \to A_k(D)$.
\end{lemma}

\begin{proof}
Let $\alpha \in Z_{k + 1}(X)$ and assume that $\alpha \sim_{rat} 0$.
This means there exists a locally finite collection of integral
closed subspaces $W_j \subset X$ of $\delta$-dimension $k + 2$
and $f_j \in R(W_j)^*$ such that
$\alpha = \sum i_{j, *}\text{div}_{W_j}(f_j)$.
Set $X' = \coprod W_i$ and consider the diagram
$$
\xymatrix{
D' \ar[d]_q \ar[r]_{i'} & X' \ar[d]^p \\
D \ar[r]^i & X
}
$$
of Remark \ref{remark-pullback-pairs}. Since $X' \to X$ is proper
we see that $i^*p_* = q_*(i')^*$ by Lemma \ref{lemma-closed-in-X-gysin}.
As we know that $q_*$ factors through rational equivalence
(Lemma \ref{lemma-proper-pushforward-rational-equivalence}), it suffices
to prove the result for $\alpha' = \sum \text{div}_{W_j}(f_j)$
on $X'$. Clearly this reduces us to the case where $X$ is integral
and $\alpha = \text{div}(f)$ for some $f \in R(X)^*$.

\medskip\noindent
Assume $X$ is integral and $\alpha = \text{div}(f)$ for some $f \in R(X)^*$.
If $X = D$, then we see that $i^*\alpha$ is equal
to $c_1(\mathcal{L}) \cap \alpha$.
This is rationally equivalent to zero by Lemma \ref{lemma-factors}.
If $D \not = X$, then we see that $i^*\text{div}_X(f)$ is equal to
$c_1(\mathcal{O}_D) \cap [D]_{n - 1}$ in $A_k(D)$ by
Lemma \ref{lemma-gysin-factors-general}. Of course
capping with $c_1(\mathcal{O}_D)$ is the zero map.
\end{proof}

\begin{lemma}
\label{lemma-gysin-commutes-cap-c1}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s, i : D \to X)$
be a triple as in Definition \ref{definition-gysin-homomorphism}.
Let $\mathcal{N}$ be an invertible $\mathcal{O}_X$-module.
Then $i^*(c_1(\mathcal{N}) \cap \alpha) = c_1(i^*\mathcal{N}) \cap i^*\alpha$
in $A_{k - 2}(D)$ for all $\alpha \in A_k(Z)$.
\end{lemma}

\begin{proof}
With exactly the same proof as in Lemma \ref{lemma-gysin-factors}
this follows from Lemmas
\ref{lemma-pushforward-cap-c1},
\ref{lemma-cap-commutative}, and
\ref{lemma-gysin-factors-general}.
\end{proof}

\begin{lemma}
\label{lemma-gysin-commutes-gysin}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s, i : D \to X)$ and
$(\mathcal{L}', s', i' : D' \to X)$ be two triples as in
Definition \ref{definition-gysin-homomorphism}. Then the diagram
$$
\xymatrix{
A_k(X) \ar[r]_{i^*} \ar[d]_{(i')^*} & A_{k - 1}(D) \ar[d] \\
A_{k - 1}(D') \ar[r] & A_{k - 2}(D \cap D')
}
$$
commutes where each of the maps is a gysin map.
\end{lemma}

\begin{proof}
Denote $j : D \cap D' \to D$ and $j' : D \cap D' \to D'$ the closed
immersions corresponding to $(\mathcal{L}|_{D'}, s|_{D'}$ and
$(\mathcal{L}'_D, s|_D)$. We have to show that
$(j')^*i^*\alpha = j^* (i')^*\alpha$ for all $\alpha \in A_k(X)$.
Let $W \subset X$ be an integral closed subscheme of dimension $k$.
We will prove the equality in case $\alpha = [W]$.
The general case will then follow from the observation in
Remark \ref{remark-infinite-sums-rational-equivalences}
(and the specific shape of our rational equivalence produced below).
We will deduce the equality for $\alpha = [W]$ from the key formula.

\medskip\noindent
We let $\sigma$ be a nonzero meromorphic section of $\mathcal{L}|_W$
which we require to be equal to $s|_W$ if $W \not \subset D$.
We let $\sigma'$ be a nonzero meromorphic section of $\mathcal{L}'|_W$
which we require to be equal to $s'|_W$ if $W \not \subset D'$.
Write
$$
\text{div}_{\mathcal{L}|_W}(\sigma) =
\sum \text{ord}_{Z_i, \mathcal{L}|_W}(\sigma)[Z_i] = \sum n_i[Z_i]
$$
and similarly
$$
\text{div}_{\mathcal{L}'|_W}(\sigma') =
\sum \text{ord}_{Z_i, \mathcal{L}'|_W}(\sigma')[Z_i] = \sum n'_i[Z_i]
$$
as in the discussion in Section \ref{section-key}.
Then we see that $Z_i \subset D$ if $n_i \not = 0$ and
$Z'_i \subset D'$ if $n'_i \not = 0$. For each $i$, let $\xi_i \in |Z_i|$
be the generic point. As in Section \ref{section-key} we choose
for each $i$ an element
$\sigma_i \in \mathcal{L}_{\xi_i}$, resp.\ $\sigma'_i \in \mathcal{L}'_{\xi_i}$
which generates over $B_i = \mathcal{O}_{W, \xi_i}^h$
and which is equal to the image of
$s$, resp.\ $s'$ if $Z_i \not \subset D$, resp.\ $Z_i \not \subset D'$.
Write $\sigma = f_i \sigma_i$ and $\sigma' = f'_i\sigma'_i$ so that
$n_i = \text{ord}_{B_i}(f_i)$ and
$n'_i = \text{ord}_{B_i}(f'_i)$.
From our definitions it follows that
$$
(j')^*i^*[W] =
\sum \text{ord}_{B_i}(f_i) \text{div}_{\mathcal{L}'|_{Z_i}}(\sigma'_i|_{Z_i})
$$
as cycles and
$$
j^*(i')^*[W] =
\sum \text{ord}_{B_i}(f'_i) \text{div}_{\mathcal{L}|_{Z_i}}(\sigma_i|_{Z_i})
$$
The key formula (Lemma \ref{lemma-key-formula}) now gives the equality
$$
\sum \left(
\text{ord}_{B_i}(f_i) \text{div}_{\mathcal{L}'|_{Z_i}}(\sigma'_i|_{Z_i}) -
\text{ord}_{B_i}(f'_i) \text{div}_{\mathcal{L}|_{Z_i}}(\sigma_i|_{Z_i})
\right) =
\sum \text{div}_{Z_i}(\partial_{B_i}(f_i, f'_i))
$$
of cycles. Note that $\text{div}_{Z_i}(\partial_{B_i}(f_i, f'_i)) = 0$ if
$Z_i \not \subset D \cap D'$ because in this case either $f_i = 1$
or $f'_i = 1$. Thus we get a rational equivalence between our specific
cycles representing $(j')^*i^*[W]$ and $j^*(i')^*[W]$ on $D \cap D' \cap W$.
\end{proof}










\section{Relative effective Cartier divisors}
\label{section-relative-effective-cartier}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-relative-effective-cartier}.
Relative effective Cartier divisors are defined
in Divisors on Spaces, Section
\ref{spaces-divisors-section-effective-Cartier-morphisms}.
To develop the basic results on chern classes of vector bundles
we only need the case where both the ambient scheme and the effective
Cartier divisor are flat over the base.

\begin{lemma}
\label{lemma-relative-effective-cartier}
In Situation \ref{situation-setup}. Let $X, Y/B$ be good.
Let $p : X \to Y$ be a flat morphism of relative dimension $r$.
Let $i : D \to X$ be a relative effective Cartier divisor
(Divisors on Spaces, Definition
\ref{spaces-divisors-definition-relative-effective-Cartier-divisor}).
Let $\mathcal{L} = \mathcal{O}_X(D)$.
For any $\alpha \in A_{k + 1}(Y)$ we have
$$
i^*p^*\alpha = (p|_D)^*\alpha
$$
in $A_{k + r}(D)$ and
$$
c_1(\mathcal{L}) \cap p^*\alpha = i_* ((p|_D)^*\alpha)
$$
in $A_{k + r}(X)$.
\end{lemma}

\begin{proof}
Let $W \subset Y$ be an integral closed subspace of $\delta$-dimension
$k + 1$. By Divisors on Spaces, Lemma
\ref{spaces-divisors-lemma-relative-Cartier}
we see that $D \cap p^{-1}W$ is an effective
Cartier divisor on $p^{-1}W$. By Lemma \ref{lemma-easy-gysin}
we get the first equality in
$$
i^*[p^{-1}W]_{k + r + 1} =
[D \cap p^{-1}W]_{k + r} =
[(p|_D)^{-1}(W)]_{k + r}.
$$
and the second because $D \cap p^{-1}(W) = (p|_D)^{-1}(W)$ as algebraic spaces.
Since by definition $p^*[W] = [p^{-1}W]_{k + r + 1}$ we see that
$i^*p^*[W] = (p|_D)^*[W]$ as cycles. If $\alpha = \sum m_j[W_j]$ is a
general $k + 1$ cycle, then we get
$i^*\alpha = \sum m_j i^*p^*[W_j] = \sum m_j(p|_D)^*[W_j]$ as cycles.
This proves then first equality. To deduce the second from the
first apply Lemma \ref{lemma-support-cap-effective-Cartier}.
\end{proof}












\section{Affine bundles}
\label{section-affine-vector}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-affine-vector}.
For an affine bundle the pullback map is surjective on Chow groups.

\begin{lemma}
\label{lemma-pullback-affine-fibres-surjective}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a quasi-compact flat morphism over $B$
of relative dimension $r$. Assume that for every $y \in Y$ we have
$X_y \cong \mathbf{A}^r_{\kappa(y)}$.
Then $f^* : A_k(Y) \to A_{k + r}(X)$ is surjective for all
$k \in \mathbf{Z}$.
\end{lemma}

\begin{proof}
Let $\alpha \in A_{k + r}(X)$. Write $\alpha = \sum m_j[W_j]$ with
$m_j \not = 0$ and $W_j$ pairwise distinct integral closed subspaces of
$\delta$-dimension $k + r$. Then the family $\{W_j\}$
is locally finite in $X$. Let $Z_j \subset Y$ be the integral
closed subspace such that we obtain a dominant morphism $W_j \to Z_j$
as in Lemma \ref{lemma-proper-image}. For any quasi-compact open
$V \subset Y$ we see that $f^{-1}(V) \cap W_j$
is nonempty only for finitely many $j$. Hence the
collection $Z_j$ of closures of images is a locally finite collection
of integral closed subspaces of $Y$.

\medskip\noindent
Consider the fibre product diagrams
$$
\xymatrix{
f^{-1}(Z_j) \ar[r] \ar[d]_{f_j} & X \ar[d]^f \\
Z_j \ar[r] & Y
}
$$
Suppose that $[W_j] \in Z_{k + r}(f^{-1}(Z_j))$
is rationally equivalent to $f_j^*\beta_j$ for some
$k$-cycle $\beta_j \in A_k(Z_j)$. Then
$\beta = \sum m_j \beta_j$ will be a $k$-cycle on $Y$
and $f^*\beta = \sum m_j f_j^*\beta_j$ will be rationally
equivalent to $\alpha$ (see
Remark \ref{remark-infinite-sums-rational-equivalences}).
This reduces us to the case $Y$ integral, and
$\alpha = [W]$ for some integral closed subscheme
of $X$ dominating $Y$. In particular we may
assume that $d = \dim_\delta(Y) < \infty$.

\medskip\noindent
Hence we can use induction on $d = \dim_\delta(Y)$.
If $d < k$, then $A_{k + r}(X) = 0$ and the lemma holds;
this is the base case of the induction.
Consider a nonempty open $V \subset Y$.
Suppose that we can show that $\alpha|_{f^{-1}(V)} = f^*\beta$
for some $\beta \in Z_k(V)$. By Lemma \ref{lemma-exact-sequence-open}
we see that
$\beta = \beta'|_V$ for some $\beta' \in Z_k(Y)$.
By the exact sequence
$A_k(f^{-1}(Y \setminus V)) \to A_k(X) \to A_k(f^{-1}(V))$
of Lemma \ref{lemma-restrict-to-open}
we see that $\alpha - f^*\beta'$ comes from
a cycle $\alpha' \in A_{k + r}(f^{-1}(Y \setminus V))$.
Since $\dim_\delta(Y \setminus V) < d$ we win by
induction on $d$.

\medskip\noindent
In particular, by replacing $Y$ by a suitable open we may assume
$Y$ is a scheme with generic point $\eta$. The isomorphism
$Y_\eta \cong \mathbf{A}^r_\eta$ extends to an isomorphism
over a nonempty open $V \subset Y$, see
Limits of Spaces, Lemma \ref{spaces-limits-lemma-descend-finite-presentation}.
This reduces us to the case of schemes which is
Chow Homology, Lemma \ref{chow-lemma-pullback-affine-fibres-surjective}.
\end{proof}

\begin{lemma}
\label{lemma-linebundle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let
$$
p :
L = \underline{\Spec}(\text{Sym}^*(\mathcal{L}))
\longrightarrow
X
$$
be the associated vector bundle over $X$.
Then $p^* : A_k(X) \to A_{k + 1}(L)$ is an isomorphism for all $k$.
\end{lemma}

\begin{proof}
For surjectivity see Lemma \ref{lemma-pullback-affine-fibres-surjective}.
Let $o : X \to L$ be the zero section of $L \to X$, i.e., the morphism
corresponding to the surjection $\text{Sym}^*(\mathcal{L}) \to \mathcal{O}_X$
which maps $\mathcal{L}^{\otimes n}$ to zero for all $n > 0$.
Then $p \circ o = \text{id}_X$ and $o(X)$ is an effective
Cartier divisor on $L$. Hence by Lemma \ref{lemma-relative-effective-cartier}
we see that $o^* \circ p^* = \text{id}$ and we conclude that $p^*$ is
injective too.
\end{proof}























\section{Bivariant intersection theory}
\label{section-bivariant}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-bivariant}.
In order to intelligently talk about higher chern classes of vector
bundles we introduce the following notion, following \cite{FM}.
It follows from \cite[Theorem 17.1]{F} that our definition agrees
with that of \cite{F} modulo the caveat that we are working in different
settings.

\begin{definition}
\label{definition-bivariant-class}
\begin{reference}
Similar to \cite[Definition 17.1]{F}
\end{reference}
In Situation \ref{situation-setup} let $f : X \to Y$ be a morphism of
good algebraic spaces over $B$. Let $p \in \mathbf{Z}$.
A {\it bivariant class $c$ of degree $p$ for $f$} is given by a rule
which assigns to every morphism $Y' \to Y$ of good algebraic spaces over $B$
and every $k$ a map
$$
c \cap - : A_k(Y') \longrightarrow A_{k - p}(X')
$$
where $X' = Y' \times_Y X$, satisfying the following conditions
\begin{enumerate}
\item if $Y'' \to Y'$ is a proper morphism, then
$c \cap (Y'' \to Y')_*\alpha'' = (X'' \to X')_*(c \cap \alpha'')$
for all $\alpha''$ on $Y''$,
\item if $Y'' \to Y'$ a morphism of good algebraic spaces over $B$
which is flat of relative dimension $r$, then
$c \cap (Y'' \to Y')^*\alpha' = (X'' \to X')^*(c \cap \alpha')$
for all $\alpha'$ on $Y'$,
\item if $(\mathcal{L}', s', i' : D' \to Y')$ is as in
Definition \ref{definition-gysin-homomorphism}
with pullback $(\mathcal{N}', t', j' : E' \to X')$ to $X'$,
then we have $c \cap (i')^*\alpha' = (j')^*(c \cap \alpha')$
for all $\alpha'$ on $Y'$.
\end{enumerate}
The collection of all bivariant classes of degree $p$ for $f$ is
denoted $A^p(X \to Y)$.
\end{definition}

\noindent
In Situation \ref{situation-setup} let $X \to Y$ and $Y \to Z$
be morphisms of good algebraic spaces over $B$. Let $p \in \mathbf{Z}$.
It is clear that $A^p(X \to Y)$ is an abelian group.
Moreover, it is clear that we have a bilinear composition
$$
A^p(X \to Y) \times A^q(Y \to Z) \to A^{p + q}(X \to Z)
$$
which is associative.
We will be most interested in $A^p(X) = A^p(X \to X)$, which will always mean
the bivariant cohomology classes for $\text{id}_X$. Namely, that is where
chern classes will live.

\begin{definition}
\label{definition-chow-cohomology}
In Situation \ref{situation-setup} let $X/B$ be good. The {\it Chow cohomology}
of $X$ is the graded $\mathbf{Z}$-algebra $A^*(X)$ whose degree
$p$ component is $A^p(X \to X)$.
\end{definition}

\noindent
Warning: It is not clear that the $\mathbf{Z}$-algebra structure
on $A^*(X)$ is commutative, but we will see that chern classes live
in its center.

\begin{remark}
\label{remark-pullback-cohomology}
In Situation \ref{situation-setup} let $f : X \to Y$ be a morphism of
good algebraic spaces over $B$.
Then there is a canonical $\mathbf{Z}$-algebra map $A^*(Y) \to A^*(X)$.
Namely, given $c \in A^p(Y)$ and $X' \to X$, then we can let $f^*c$
be defined by the map $c \cap - : A_k(X') \to A_{k - p}(X')$ which is
given by thinking of $X'$ as an algebraic space over $Y$.
\end{remark}

\begin{lemma}
\label{lemma-cap-c1-bivariant}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Then the rule that to $f : X' \to X$ assignes
$c_1(f^*\mathcal{L}) \cap - : A_k(X') \to A_{k - 1}(X')$
is a bivariant class of degree $1$.
\end{lemma}

\begin{proof}
This follows from Lemmas \ref{lemma-factors},
\ref{lemma-pushforward-cap-c1},
\ref{lemma-flat-pullback-cap-c1}, and
\ref{lemma-gysin-commutes-cap-c1}.
\end{proof}

\begin{lemma}
\label{lemma-flat-pullback-bivariant}
In Situation \ref{situation-setup} let $f : X \to Y$ be a morphism
of good algebraic spaces over $B$ which is flat of relative dimension $r$.
Then the rule that to $Y' \to Y$ assignes
$(f')^* : A_k(Y') \to A_{k + r}(X')$ where $X' = X \times_Y Y'$
is a bivariant class of degree $-r$.
\end{lemma}

\begin{proof}
This follows from
Lemmas \ref{lemma-flat-pullback-rational-equivalence},
\ref{lemma-compose-flat-pullback},
\ref{lemma-flat-pullback-proper-pushforward}, and
\ref{lemma-gysin-flat-pullback}.
\end{proof}

\begin{lemma}
\label{lemma-gysin-bivariant}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $(\mathcal{L}, s, i : D \to X)$ be a triple as in
Definition \ref{definition-gysin-homomorphism}.
Then the rule that to $f : X' \to X$ assignes
$(i')^* : A_k(X') \to A_{k - 1}(D')$ where $D' = D \times_X X'$
is a bivariant class of degree $1$.
\end{lemma}

\begin{proof}
This follows from Lemmas \ref{lemma-gysin-factors},
\ref{lemma-closed-in-X-gysin},
\ref{lemma-gysin-flat-pullback}, and
\ref{lemma-gysin-commutes-gysin}.
\end{proof}

\begin{lemma}
\label{lemma-push-proper-bivariant}
In Situation \ref{situation-setup} let $f : X \to Y$ and
$g : Y \to Z$ be morphisms of good algebraic spaces over $B$.
Let $c \in A^p(X \to Z)$ and assume $f$ is proper.
Then the rule that to $X' \to X$ assignes
$\alpha \longmapsto f_*(c \cap \alpha)$
is a bivariant class of degree $p$.
\end{lemma}

\begin{proof}
This follows from Lemmas \ref{lemma-compose-pushforward},
\ref{lemma-flat-pullback-proper-pushforward}, and
\ref{lemma-closed-in-X-gysin}.
\end{proof}

\noindent
Here we see that $c_1(\mathcal{L})$ is in the center of $A^*(X)$.

\begin{lemma}
\label{lemma-c1-center}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Then $c_1(\mathcal{L}) \in A^1(X)$ commutes with every
element $c \in A^p(X)$.
\end{lemma}

\begin{proof}
Let $p : L \to X$ be as in Lemma \ref{lemma-linebundle} and let $o : X \to L$
be the zero section. Observe that $p^*\mathcal{L}^{\otimes -1}$ has a
canonical section whose vanishing locus is exactly the
effective Cartier divisor $o(X)$. Let $\alpha \in A_k(X)$. Then we see that
$$
p^*(c_1(\mathcal{L}^{\otimes -1}) \cap \alpha) =
c_1(p^*\mathcal{L}^{\otimes -1}) \cap p^*\alpha =
o_* o^* p^*\alpha
$$
by Lemmas \ref{lemma-flat-pullback-cap-c1} and
\ref{lemma-relative-effective-cartier}.
Since $c$ is a bivariant class we have
\begin{align*}
p^*(c \cap c_1(\mathcal{L}^{\otimes -1}) \cap \alpha)
& =
c \cap p^*(c_1(\mathcal{L}^{\otimes -1}) \cap \alpha) \\
& =
c \cap o_* o^* p^*\alpha \\
& =
o_* o^* p^*(c \cap \alpha) \\
& =
p^*(c_1(\mathcal{L}^{\otimes -1}) \cap c \cap \alpha)
\end{align*}
(last equality by the above applied to $c \cap \alpha$).
Since $p^*$ is injective by a lemma cited above we get that
$c_1(\mathcal{L}^{\otimes -1})$
is in the center of $A^*(X)$. This proves the lemma.
\end{proof}

\noindent
Here a criterion for when a bivariant class is zero.

\begin{lemma}
\label{lemma-bivariant-zero}
In Situation \ref{situation-setup} let $X/B$ be good. Let $c \in A^p(X)$.
Then $c$ is zero if and only if $c \cap [Y] = 0$ in $A_*(Y)$
for every integral algebraic space $Y$ locally of finite type over $X$.
\end{lemma}

\begin{proof}
The if direction is clear. For the converse, assume that $c \cap [Y] = 0$ in
$A_*(Y)$ for every integral algebraic space $Y$ locally of finite type over $X$.
Let $X' \to X$ be locally of finite type. Let $\alpha \in A_k(X')$.
Write $\alpha = \sum n_i [Y_i]$ with $Y_i \subset X'$ a locally finite
collection of integral closed subschemes of $\delta$-dimension $k$.
Then we see that $\alpha$ is pushforward of the cycle
$\alpha' = \sum n_i[Y_i]$ on $X'' = \coprod Y_i$ under the
proper morphism $X'' \to X'$. By the properties of bivariant
classes it suffices to prove that $c \cap \alpha' = 0$ in $A_{k - p}(X'')$.
We have $A_{k - p}(X'') = \prod A_{k - p}(Y_i)$ as follows immediately
from the definitions. The projection maps $A_{k - p}(X'') \to A_{k - p}(Y_i)$
are given by flat pullback. Since capping with $c$ commutes with
flat pullback, we see that it suffices to show that $c \cap [Y_i]$
is zero in $A_{k - p}(Y_i)$ which is true by assumption.
\end{proof}















\section{Projective space bundle formula}
\label{section-projective-space-bundle-formula}

\noindent
In Situation \ref{situation-setup} let $X/B$ be good.
Consider a finite locally free $\mathcal{O}_X$-module
$\mathcal{E}$ of rank $r$.
Our convention is that the {\it projective bundle associated to
$\mathcal{E}$} is the morphism
$$
\xymatrix{
\mathbf{P}(\mathcal{E}) =
\underline{\text{Proj}}_X(\text{Sym}^*(\mathcal{E}))
\ar[r]^-\pi
& X
}
$$
over $X$ with
$\mathcal{O}_{\mathbf{P}(\mathcal{E})}(1)$ normalized so that
$\pi_*(\mathcal{O}_{\mathbf{P}(\mathcal{E})}(1)) = \mathcal{E}$.
In particular there is a surjection
$\pi^*\mathcal{E} \to \mathcal{O}_{\mathbf{P}(\mathcal{E})}(1)$.
We will say informally ``let $(\pi : P \to X, \mathcal{O}_P(1))$
be the projective bundle associated to $\mathcal{E}$'' to denote
the situation where $P = \mathbf{P}(\mathcal{E})$ and
$\mathcal{O}_P(1) = \mathcal{O}_{\mathbf{P}(\mathcal{E})}(1)$.

\begin{lemma}
\label{lemma-cap-projective-bundle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module
$\mathcal{E}$ of rank $r$. Let $(\pi : P \to X, \mathcal{O}_P(1))$
be the projective bundle associated to $\mathcal{E}$.
For any $\alpha \in A_k(X)$ the element
$$
\pi_*\left(
c_1(\mathcal{O}_P(1))^s \cap \pi^*\alpha
\right)
\in
A_{k + r - 1 - s}(X)
$$
is $0$ if $s < r - 1$ and is equal to $\alpha$ when $s = r - 1$.
\end{lemma}

\begin{proof}
Let $Z \subset X$ be an integral closed subspace of $\delta$-dimension $k$.
We will prove the lemma for $\alpha = [Z]$. We omit the argument
deducing the general case from this special case; hint: argue as in
Remark \ref{remark-infinite-sums-rational-equivalences}.

\medskip\noindent
Let $P_Z = P \times_X Z$ be the base change; of course
$\pi_Z : P_Z \to Z$ is the projective bundle associated to $\mathcal{E}|_Z$
and $\mathcal{O}_P(1)$ pulls back to the corresponding
invertible module on $P_Z$. Since $c_1(\mathcal{O}_P(1) \cap -$, and
$\pi^*$ are bivariant classes by Lemmas
\ref{lemma-cap-c1-bivariant} and \ref{lemma-flat-pullback-bivariant}
we see that
$$
\pi_*\left(
c_1(\mathcal{O}_P(1))^s \cap \pi^*[Z]
\right)
=
(Z \to X)_*\pi_{Z, *}\left(
c_1(\mathcal{O}_{P_Z}(1))^s \cap \pi_Z^*[Z]
\right)
$$
Hence it suffices to prove the lemma in case $X$ is integral
and $\alpha  = [X]$.

\medskip\noindent
Assume $X$ is integral, $\dim_\delta(X) = k$, and $\alpha = [X]$.
Note that $\pi^*[X] = [P]$ as $P$ is integral of
$\delta$-dimension $r - 1$. If $s < r - 1$, then by construction
$c_1(\mathcal{O}_P(1))^s \cap [P]$ a $(k + r - 1 - s)$-cycle.
Hence the pushforward of this cycle is zero for dimension reasons.

\medskip\noindent
Let $s = r - 1$. By the argument given above we see that
$\pi_*(c_1(\mathcal{O}_P(1))^s \cap [P]) = n [X]$
for some $n \in \mathbf{Z}$. We want to show that $n = 1$.
For the same dimension reasons as above it suffices to prove this
result after replacing $X$ by a dense open.
Thus we may assume $X$ is a scheme and the result follows
from Chow Homology, Lemma \ref{chow-lemma-cap-projective-bundle}.
\end{proof}

\begin{lemma}[Projective space bundle formula]
\label{lemma-chow-ring-projective-bundle}
Let $(S, \delta)$ be as in Situation \ref{situation-setup}.
Let $X$ be locally of finite type over $S$.
Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module
$\mathcal{E}$ of rank $r$. Let $(\pi : P \to X, \mathcal{O}_P(1))$
be the projective bundle associated to $\mathcal{E}$.
The map
$$
\bigoplus\nolimits_{i = 0}^{r - 1}
A_{k + i}(X)
\longrightarrow
A_{k + r - 1}(P),
$$
$$
(\alpha_0, \ldots, \alpha_{r-1})
\longmapsto
\pi^*\alpha_0 +
c_1(\mathcal{O}_P(1)) \cap \pi^*\alpha_1
+ \ldots +
c_1(\mathcal{O}_P(1))^{r - 1} \cap \pi^*\alpha_{r-1}
$$
is an isomorphism.
\end{lemma}

\begin{proof}
Fix $k \in \mathbf{Z}$. We first show the map is injective.
Suppose that $(\alpha_0, \ldots, \alpha_{r - 1})$ is an element
of the left hand side that maps to zero.
By Lemma \ref{lemma-cap-projective-bundle} we see that
$$
0 = \pi_*(\pi^*\alpha_0 +
c_1(\mathcal{O}_P(1)) \cap \pi^*\alpha_1
+ \ldots +
c_1(\mathcal{O}_P(1))^{r - 1} \cap \pi^*\alpha_{r-1})
= \alpha_{r - 1}
$$
Next, we see that
$$
0 = \pi_*(c_1(\mathcal{O}_P(1)) \cap (\pi^*\alpha_0 +
c_1(\mathcal{O}_P(1)) \cap \pi^*\alpha_1
+ \ldots +
c_1(\mathcal{O}_P(1))^{r - 2} \cap \pi^*\alpha_{r - 2}))
= \alpha_{r - 2}
$$
and so on. Hence the map is injective.

\medskip\noindent
To prove the map is surjective, we will argue exactly
as in the proof of Lemma \ref{lemma-pullback-affine-fibres-surjective}
to reduce to the case of schemes.
We urge the reader to skip the proof.

\medskip\noindent
Let $\beta \in A_{k + r - 1}(P)$. Write $\beta = \sum m_j[W_j]$ with
$m_j \not = 0$ and $W_j$ pairwise distinct integral closed subspaces of
$\delta$-dimension $k + r$. Then the family $\{W_j\}$
is locally finite in $P$. Let $Z_j \subset X$ be the ``image''
of $W_j$ as in Lemma \ref{lemma-proper-image}. For any quasi-compact open
$U \subset X$ we see that $\pi^{-1}(U) \cap W_j$
is nonempty only for finitely many $j$. Hence the
collection $Z_j$ of images is a locally finite collection
of integral closed subspaces of $X$.

\medskip\noindent
Consider the fibre product diagrams
$$
\xymatrix{
P_j \ar[r] \ar[d]_{\pi_j} & P \ar[d]^\pi \\
Z_j \ar[r] & X
}
$$
Suppose that $[W_j] \in Z_{k + r - 1}(P_j)$
is rationally equivalent to
$$
\pi_j^*\alpha_{j, 0} +
c_1(\mathcal{O}(1)) \cap \pi_j^*\alpha_{j, 1} +
\ldots +
c_1(\mathcal{O}(1))^{r - 1} \cap \pi_j^*\alpha_{j, r - 1}
$$
for some $(k + i)$-cycle $\alpha_{j, i} \in A_{k + i}(Z_j)$. Then
$\alpha_i = \sum m_j \beta_{j, i}$ will be a $(k + i)$-cycle on $X$
and
$$
\pi^*\alpha_0 +
c_1(\mathcal{O}(1)) \cap \pi^*\alpha_1 +
\ldots +
c_1(\mathcal{O}(1))^{r - 1} \cap \pi^*\alpha_{r - 1}
$$
will be rationally equivalent to $\beta$ (see
Remark \ref{remark-infinite-sums-rational-equivalences}).
This reduces us to the case $X$ integral, and
$\alpha = [W]$ for some integral closed subscheme
of $P$ dominating $X$. In particular we may
assume that $d = \dim_\delta(X) < \infty$.

\medskip\noindent
Hence we can use induction on $d = \dim_\delta(X)$.
If $d < k$, then $A_{k + r - 1}(X) = 0$ and the lemma holds;
this is the base case of the induction.
Consider a nonempty open $U \subset X$.
Suppose that we can show that
$$
\beta|_{\pi^{-1}(U)} =
\pi^*\alpha_0 +
c_1(\mathcal{O}(1)) \cap \pi^*\alpha_1 +
\ldots +
c_1(\mathcal{O}(1))^{r - 1} \cap \pi^*\alpha_{r - 1}
$$
for some $\alpha_i \in Z_{k + i}(U)$.
By Lemma \ref{lemma-exact-sequence-open} we see that
$\alpha_i = \alpha'_i|_U$ for some $\alpha'_i \in Z_{k + i}(X)$.
By the exact sequences
$A_{k + i}(\pi^{-1}(X \setminus U)) \to A_{k + i}(P) \to
A_{k + i}(\pi^{-1}(U))$
of Lemma \ref{lemma-restrict-to-open}
we see that
$$
\beta -
\left(\pi^*\alpha'_0 +
c_1(\mathcal{O}(1)) \cap \pi^*\alpha'_1 +
\ldots +
c_1(\mathcal{O}(1))^{r - 1} \cap \pi^*\alpha'_{r - 1}\right)
$$
comes from a cycle $\beta' \in A_{k + r}(\pi^{-1}(X \setminus U))$.
Since $\dim_\delta(X \setminus U) < d$ we win by
induction on $d$.

\medskip\noindent
In particular, by replacing $X$ by a suitable open we may assume
$X$ is a scheme and we have reduced our problem to
Chow Homology, Lemma \ref{chow-lemma-chow-ring-projective-bundle}.
\end{proof}

\begin{lemma}
\label{lemma-vectorbundle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$.
Let
$$
p :
E = \underline{\Spec}(\text{Sym}^*(\mathcal{E}))
\longrightarrow
X
$$
be the associated vector bundle over $X$.
Then $p^* : A_k(X) \to A_{k + r}(E)$ is an isomorphism for all $k$.
\end{lemma}

\begin{proof}
(For the case of linebundles, see Lemma \ref{lemma-linebundle}.)
For surjectivity see Lemma \ref{lemma-pullback-affine-fibres-surjective}.
Let $(\pi  : P \to X, \mathcal{O}_P(1))$
be the projective space bundle associated
to the finite locally free sheaf $\mathcal{E} \oplus \mathcal{O}_X$.
Let $s \in \Gamma(P, \mathcal{O}_P(1))$ correspond to the global
section $(0, 1) \in \Gamma(X, \mathcal{E} \oplus \mathcal{O}_X)$.
Let $D = Z(s) \subset P$. Note that
$(\pi|_D : D \to X , \mathcal{O}_P(1)|_D)$
is the projective space bundle associated
to $\mathcal{E}$. We denote $\pi_D = \pi|_D$ and
$\mathcal{O}_D(1) = \mathcal{O}_P(1)|_D$.
Moreover, $D$ is an effective
Cartier divisor on $P$. Hence $\mathcal{O}_P(D) = \mathcal{O}_P(1)$
(see Divisors on Spaces, Lemma \ref{spaces-divisors-lemma-characterize-OD}).
Also there is an isomorphism
$E \cong P \setminus D$. Denote $j : E \to P$ the
corresponding open immersion.
For injectivity we use that the kernel of
$$
j^* :
A_{k + r}(P)
\longrightarrow
A_{k + r}(E)
$$
are the cycles supported in the effective Cartier divisor $D$,
see Lemma \ref{lemma-restrict-to-open}. So if $p^*\alpha = 0$, then
$\pi^*\alpha = i_*\beta$ for some $\beta \in A_{k + r}(D)$.
By Lemma \ref{lemma-chow-ring-projective-bundle} we may write
$$
\beta = \pi_D^*\beta_0 +
\ldots + c_1(\mathcal{O}_D(1))^{r - 1} \cap \pi_D^* \beta_{r - 1}.
$$
for some $\beta_i \in A_{k + i}(X)$.
By Lemmas \ref{lemma-relative-effective-cartier}
and \ref{lemma-pushforward-cap-c1}
this implies
$$
\pi^*\alpha = i_*\beta =
c_1(\mathcal{O}_P(1)) \cap \pi^*\beta_0 +
\ldots +
c_1(\mathcal{O}_D(1))^r \cap \pi^*\beta_{r - 1}.
$$
Since the rank of $\mathcal{E} \oplus \mathcal{O}_X$ is $r + 1$
this contradicts Lemma \ref{lemma-pushforward-cap-c1} unless all
$\alpha$ and all $\beta_i$ are zero.
\end{proof}








\section{The Chern classes of a vector bundle}
\label{section-chern-classes-vector-bundles}

\noindent
This section is the analogue of Chow Homology, Sections
\ref{chow-section-chern-classes-vector-bundles} and
\ref{chow-section-intersecting-chern-classes}.
However, contrary to what is done there, we directly
define the chern classes of a vector bundle as bivariant classes.
This saves a considerable amount of work.

\begin{lemma}
\label{lemma-segre-classes}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$.
Let $(\pi : P \to X, \mathcal{O}_P(1))$ be the projective space
bundle associated to $\mathcal{E}$. For every
morphism $X' \to X$ of good algebraic spaces over $B$
there are unique maps
$$
c_i(\mathcal{E}) \cap - : A_k(X') \longrightarrow A_{k - i}(X'),\quad
i = 0, \ldots, r
$$
such that for $\alpha \in A_k(X')$ we have
$c_0(\mathcal{E}) \cap \alpha = \alpha$ and
$$
\sum\nolimits_{i = 0, \ldots, r}
(-1)^i c_1(\mathcal{O}_{P'}(1))^i \cap
(\pi')^*\left(c_{r - i}(\mathcal{E}) \cap \alpha\right) = 0
$$
where $\pi' : P' \to X'$ is the base change of $\pi$.
Moreover, these maps define a bivariant class
$c_i(\mathcal{E})$ of degree $i$ on $X$.
\end{lemma}

\begin{proof}
Uniqueness and existence of the maps $c_i(\mathcal{E}) \cap -$
follows immediately from Lemma \ref{lemma-chow-ring-projective-bundle}
and the given description of $c_0(\mathcal{E})$. For every $i \in \mathbf{Z}$
the rule which to every morphism $X' \to X$ of good algebraic spaces
over $B$ assigns the map
$$
t_i(\mathcal{E}) \cap - :
A_k(X') \longrightarrow A_{k - i}(X'),\quad
\alpha \longmapsto
\pi'_*(c_1(\mathcal{O}_{P'}(1))^{r - 1 + i} \cap (\pi')^*\alpha)
$$
is a bivariant class\footnote{Up to signs these are
the Segre classes of $\mathcal{E}$.} by Lemmas \ref{lemma-cap-c1-bivariant},
\ref{lemma-flat-pullback-bivariant}, and
\ref{lemma-push-proper-bivariant}.
By Lemma \ref{lemma-cap-projective-bundle} we have
$t_i(\mathcal{E}) = 0$ for $i < 0$ and $t_0(\mathcal{E}) = 1$.
Applying pushforward to the equation in the statement of the lemma
we find from Lemma \ref{lemma-cap-projective-bundle} that
$$
(-1)^r t_1(\mathcal{E}) + (-1)^{r - 1}c_1(\mathcal{E}) = 0
$$
In particular we find that $c_1(\mathcal{E})$ is a bivariant class.
If we multiply the equation in the statement of the lemma by
$c_1(\mathcal{O}_{P'}(1))$ and push the result forward to $X'$
we find
$$
(-1)^r t_2(\mathcal{E}) +
(-1)^{r - 1} t_1(\mathcal{E}) \cap c_1(\mathcal{E}) +
(-1)^{r - 2} c_2(\mathcal{E}) = 0
$$
As before we conclude that $c_2(\mathcal{E})$ is a bivariant class.
And so on.
\end{proof}

\begin{definition}
\label{definition-chern-classes}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free sheaf of rank $r$ on $X$.
For $i = 0, \ldots, r$ the {\it $i$th chern class of $\mathcal{E}$}
is the bivariant class $c_i(\mathcal{E}) \in A^i(X)$ of degree $i$
constructed in Lemma \ref{lemma-segre-classes}.
The {\it total chern class of $\mathcal{E}$}
is the formal sum
$$
c(\mathcal{E}) =
c_0(\mathcal{E}) + c_1(\mathcal{E}) + \ldots + c_r(\mathcal{E})
$$
which is viewed as a nonhomogeneous bivariant class on $X$.
\end{definition}

\noindent
For convenience we often set $c_i(\mathcal{E}) = 0$
for $i > r$ and $i < 0$. By definition
we have $c_0(\mathcal{E}) = 1 \in A^0(X)$.
Here is a sanity check.

\begin{lemma}
\label{lemma-first-chern-class}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
The first chern class of $\mathcal{L}$ on $X$ of
Definition \ref{definition-chern-classes}
is equal to the bivariant class of Lemma \ref{lemma-cap-c1-bivariant}.
\end{lemma}

\begin{proof}
Namely, in this case $P = \mathbf{P}(\mathcal{L}) = X$ with
$\mathcal{O}_P(1) = \mathcal{L}$ by our normalization of the
projective bundle, see Section \ref{section-projective-space-bundle-formula}.
Hence the equation in Lemma \ref{lemma-segre-classes}
reads
$$
(-1)^0 c_1(\mathcal{L})^0 \cap c^{new}_1(\mathcal{L}) \cap \alpha +
(-1)^1 c_1(\mathcal{L})^1 \cap c^{new}_0(\mathcal{L}) \cap \alpha = 0
$$
where $c_i^{new}(\mathcal{L})$ is as in
Definition \ref{definition-chern-classes}.
Since $c_0^{new}(\mathcal{L}) = 1$ and $c_1(\mathcal{L})^0 = 1$
we conclude.
\end{proof}

\noindent
Next we see that chern classes are in the center of the bivariant
Chow cohomology ring $A^*(X)$.

\begin{lemma}
\label{lemma-cap-commutative-chern}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a locally free $\mathcal{O}_X$-module of rank $r$.
Then $c_j(\mathcal{L}) \in A^j(X)$ commutes with every
element $c \in A^p(X)$. In particular, if $\mathcal{F}$ is a
second locally free $\mathcal{O}_X$-module on $X$ of rank $s$, then
$$
c_i(\mathcal{E}) \cap c_j(\mathcal{F}) \cap \alpha
=
c_j(\mathcal{F}) \cap c_i(\mathcal{E}) \cap \alpha
$$
as elements of $A_{k - i - j}(X)$ for all $\alpha \in A_k(X)$.
\end{lemma}

\begin{proof}
Let $X' \to X$ be a morphism of good algebraic spaces over $B$.
Let $\alpha \in A_k(X')$. Write $\alpha_j = c_j(\mathcal{E}) \cap \alpha$, so
$\alpha_0 = \alpha$. By Lemma \ref{lemma-segre-classes} we have
$$
\sum\nolimits_{i = 0}^r
(-1)^i c_1(\mathcal{O}_{P'}(1))^i \cap
(\pi')^*(\alpha_{r - i}) = 0
$$
in the chow group of the projective bundle
$(\pi' : P' \to X', \mathcal{O}_{P'}(1))$
associated to $(X' \to X)^*\mathcal{E}$.
Applying $c \cap -$ and using Lemma \ref{lemma-c1-center}
and the properties of bivariant classes we obtain
$$
\sum\nolimits_{i = 0}^r
(-1)^i c_1(\mathcal{O}_{P'}(1))^i \cap
\pi^*(c \cap \alpha_{r - i}) = 0
$$
in the Chow group of $P'$. Hence we see that $c \cap \alpha_j$ is
equal to $c_j(\mathcal{E}) \cap (c \cap \alpha)$ by the uniqueness in
Lemma \ref{lemma-segre-classes}. This proves the lemma.
\end{proof}

\begin{remark}
\label{remark-extend-to-finite-locally-free}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module.
If the rank of $\mathcal{E}$ is not constant then we can
still define the chern classes of $\mathcal{E}$. Namely, in this
case we can write
$$
X = X_0 \amalg X_1 \amalg X_2 \amalg \ldots
$$
where $X_r \subset X$ is the open and closed subspace where
the rank of $\mathcal{E}$ is $r$. If $X' \to X$ is a morphism
of good algebraic spaces over $B$, then we obtain by
pullback a corresponding decomposition of $X'$ and we find that
$$
A_*(X') = \prod\nolimits_{r \geq 0} A_*(X'_r)
$$
by our definitions. Then we simply define $c_i(\mathcal{E})$
to be the bivariant class which preserves these direct
product decompositions and acts by the already defined
operations $c_i(\mathcal{E}|_{X_r}) \cap -$
on the factors. Observe that in this setting it may happen
that $c_i(\mathcal{E})$ is nonzero for infinitely many $i$.
\end{remark}












\section{Polynomial relations among chern classes}
\label{section-relations-chern-classes}

\noindent
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}_i$ be a finite collection of finite locally
free $\mathcal{O}_X$-modules. By Lemma \ref{lemma-cap-commutative-chern}
we see that the chern classes
$$
c_j(\mathcal{E}_i) \in A^*(X)
$$
generate a commutative (and even central) $\mathbf{Z}$-subalgebra of the
Chow cohomology $A^*(X)$.
Thus we can say what it means for a polynomial in these chern classes
to be zero, or for two polynomials to be the same. As an example, saying that
$c_1(\mathcal{E}_1)^5 + c_2(\mathcal{E}_2)c_3(\mathcal{E}_3) = 0$
means that the operations
$$
A_k(Y) \longrightarrow A_{k - 5}(Y), \quad
\alpha \longmapsto
c_1(\mathcal{E}_1)^5 \cap \alpha +
c_2(\mathcal{E}_2) \cap c_3(\mathcal{E}_3) \cap \alpha
$$
are zero for all morphisms $f : Y \to X$ of good algebraic spaces over $B$.
By Lemma \ref{lemma-bivariant-zero}
this is equivalent to the requirement that given any morphism
$f : Y \to X$ where $Y$ is an integral algebraic space
locally of finite type over $X$ the cycle
$$
c_1(\mathcal{E}_1)^5 \cap [Y] +
c_2(\mathcal{E}_2) \cap c_3(\mathcal{E}_3) \cap [Y]
$$
is zero in $A_{\dim(Y) - 5}(Y)$.

\medskip\noindent
A specific example is the relation
$$
c_1(\mathcal{L} \otimes_{\mathcal{O}_X} \mathcal{N})
=
c_1(\mathcal{L}) + c_1(\mathcal{N})
$$
proved in Lemma \ref{lemma-c1-cap-additive}.
More generally, here is what happens when we tensor an
arbitrary locally free sheaf by an invertible sheaf.

\begin{lemma}
\label{lemma-chern-classes-E-tensor-L}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free sheaf of
rank $r$ on $X$. Let $\mathcal{L}$ be an invertible
sheaf on $X$. Then we have
\begin{equation}
\label{equation-twist}
c_i({\mathcal E} \otimes {\mathcal L})
=
\sum\nolimits_{j = 0}^i
\binom{r - i + j}{j} c_{i - j}({\mathcal E}) c_1({\mathcal L})^j
\end{equation}
in $A^*(X)$.
\end{lemma}

\begin{proof}
The proof is identical to the proof of
Chow Homology, Lemma \ref{chow-lemma-chern-classes-E-tensor-L}
replacing the lemmas used there by Lemmas \ref{lemma-bivariant-zero} and
\ref{lemma-segre-classes}.
\end{proof}












\section{Additivity of chern classes}
\label{section-additivity-chern-classes}

\noindent
This section is the analogue of Chow Homology, Section
\ref{chow-section-additivity-chern-classes}.

\begin{lemma}
\label{lemma-get-rid-of-trivial-subbundle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$, $\mathcal{F}$ be finite locally free sheaves
on $X$ of ranks $r$, $r - 1$ which fit into a short
exact sequence
$$
0 \to \mathcal{O}_X \to \mathcal{E} \to \mathcal{F} \to 0
$$
Then we have
$$
c_r(\mathcal{E}) = 0, \quad
c_j(\mathcal{E}) = c_j(\mathcal{F}), \quad j = 0, \ldots, r - 1
$$
in $A^*(X)$.
\end{lemma}

\begin{proof}
The proof is identical to the proof of
Chow Homology, Lemma \ref{chow-lemma-get-rid-of-trivial-subbundle}
replacing the lemmas used there by
Lemmas \ref{lemma-bivariant-zero},
\ref{lemma-relative-effective-cartier},
\ref{lemma-pushforward-cap-c1}, and
\ref{lemma-segre-classes}.
\end{proof}

\begin{lemma}
\label{lemma-additivity-invertible-subsheaf}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$, $\mathcal{F}$ be finite locally free sheaves
on $X$ of ranks $r$, $r - 1$ which fit into a short
exact sequence
$$
0 \to \mathcal{L} \to \mathcal{E} \to \mathcal{F} \to 0
$$
where $\mathcal{L}$ is an invertible sheaf.
Then
$$
c(\mathcal{E}) = c(\mathcal{L}) c(\mathcal{F})
$$
in $A^*(X)$.
\end{lemma}

\begin{proof}
The proof is identical to the proof of
Chow Homology, Lemma \ref{chow-lemma-additivity-invertible-subsheaf}
replacing the lemmas used there by
Lemmas
\ref{lemma-get-rid-of-trivial-subbundle} and
\ref{lemma-chern-classes-E-tensor-L}.
\end{proof}

\begin{lemma}
\label{lemma-additivity-chern-classes}
In Situation \ref{situation-setup} let $X/B$ be good.
Suppose that $\mathcal{E}$ sits in an exact sequence
$$
0
\to
\mathcal{E}_1
\to
\mathcal{E}
\to
\mathcal{E}_2
\to
0
$$
of finite locally free sheaves $\mathcal{E}_i$ of rank $r_i$.
The total chern classes satisfy
$$
c(\mathcal{E}) = c(\mathcal{E}_1) c(\mathcal{E}_2)
$$
in $A^*(X)$.
\end{lemma}

\begin{proof}
The proof is identical to the proof of
Chow Homology, Lemma \ref{chow-lemma-additivity-chern-classes}
replacing the lemmas used there by
Lemmas \ref{lemma-bivariant-zero},
\ref{lemma-additivity-invertible-subsheaf}, and
\ref{lemma-segre-classes}.
\end{proof}

\begin{lemma}
\label{lemma-chern-filter-by-linebundles}
In Situation \ref{situation-setup} let $X/B$ be good.
Let ${\mathcal L}_i$, $i = 1, \ldots, r$ be invertible
$\mathcal{O}_X$-modules.
Let $\mathcal{E}$ be a locally free rank
$\mathcal{O}_X$-module endowed with a filtration
$$
0 = \mathcal{E}_0 \subset \mathcal{E}_1 \subset \mathcal{E}_2
\subset \ldots \subset \mathcal{E}_r = \mathcal{E}
$$
such that $\mathcal{E}_i/\mathcal{E}_{i - 1} \cong \mathcal{L}_i$.
Set $c_1({\mathcal L}_i) = x_i$. Then
$$
c(\mathcal{E})
=
\prod\nolimits_{i = 1}^r (1 + x_i)
$$
in $A^*(X)$.
\end{lemma}

\begin{proof}
Apply Lemma \ref{lemma-additivity-invertible-subsheaf} and induction.
\end{proof}



















\section{The splitting principle}
\label{section-splitting-principle}

\noindent
This section is the analogue of Chow Homology, Section
\ref{chow-section-additivity-chern-classes}.

\begin{lemma}
\label{lemma-splitting-principle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}_i$ be a finite collection of locally free
$\mathcal{O}_X$-modules of rank $r_i$. There exists a projective
flat morphism $\pi : P \to X$ of relative dimension $d$ such that
\begin{enumerate}
\item for any morphism $f : Y \to X$ of good algebraic spaces
over $B$ the map
$\pi_Y^* : A_*(Y) \to A_{* + d}(Y \times_X P)$ is injective, and
\item each $\pi^*\mathcal{E}_i$ has a filtration
whose successive quotients $\mathcal{L}_{i, 1}, \ldots, \mathcal{L}_{i, r_i}$
are invertible ${\mathcal O}_P$-modules.
\end{enumerate}
\end{lemma}

\begin{proof}
We prove this by induction on the integer $r = \sum r_i$.
If $r = 0$ we can take $\pi = \text{id}_X$.
If $r_i = 1$ for all $i$, then we can also take $\pi = \text{id}_X$.
Assume that $r_{i_0} > 1$ for some $i_0$.
Let $(\pi : P \to X, \mathcal{O}_P(1))$
be the projective bundle associated to $\mathcal{E}_{i_0}$.
The canonical map $\pi^*\mathcal{E}_{i_0} \to \mathcal{O}_P(1)$
is surjective and hence its kernel $\mathcal{E}'_{i_0}$
is finite locally free of rank $r_{i_0} - 1$.
Observe that $\pi_Y^*$ is injective for any
morphism $f : Y \to X$ of good algebraic spaces
over $B$, see Lemma \ref{lemma-chow-ring-projective-bundle}.
Thus it suffices to prove the lemma for
$P$ and the locally free sheaves $\pi^*\mathcal{E}_i$.
However, because we have the subbundle
$\mathcal{E}_{i_0} \subset \pi^*\mathcal{E}_{i_0}$
with invertible quotient, it now suffices to prove
the lemma for the collection
$\{\mathcal{E}_i\}_{i \not = i_0} \cup \{\mathcal{E}'_{i_0}\}$.
This decreases $r$ by $1$ and we win by induction hypothesis.
\end{proof}

\noindent
Rather than explaining what the splitting principle says, let
us use it in the proof of some lemmas.

\begin{lemma}
\label{lemma-chern-classes-dual}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ be a finite locally free $\mathcal{O}_X$-module
with dual $\mathcal{E}^\vee$. Then
$$
c_i(\mathcal{E}^\vee) = (-1)^i c_i(\mathcal{E})
$$
in $A^i(X)$.
\end{lemma}

\begin{proof}
Choose a morphism $\pi : P \to X$ as in
Lemma \ref{lemma-splitting-principle}.
By the injectivity of $\pi^*$ (after any base change)
it suffices to prove the relation between
the chern classes of $\mathcal{E}$ and $\mathcal{E}^\vee$
after pulling back to $P$. Thus we may assume there
exist invertible $\mathcal{O}_X$-modules
${\mathcal L}_i$, $i = 1, \ldots, r$
and a filtration
$$
0 = \mathcal{E}_0 \subset \mathcal{E}_1 \subset \mathcal{E}_2
\subset \ldots \subset \mathcal{E}_r = \mathcal{E}
$$
such that $\mathcal{E}_i/\mathcal{E}_{i - 1} \cong \mathcal{L}_i$.
Then we obtain the dual filtration
$$
0 = \mathcal{E}_r^\perp \subset \mathcal{E}_1^\perp \subset \mathcal{E}_2^\perp
\subset \ldots \subset \mathcal{E}_0^\perp = \mathcal{E}^\vee
$$
such that $\mathcal{E}_{i - 1}^\perp/\mathcal{E}_i^\perp \cong
\mathcal{L}_i^{\otimes -1}$.
Set $x_i = c_1(\mathcal{L}_i)$.
Then $c_1(\mathcal{L}_i^{\otimes -1}) = - x_i$
by Lemma \ref{lemma-c1-cap-additive}.
By Lemma \ref{lemma-chern-filter-by-linebundles}
we have
$$
c(\mathcal{E}) = \prod\nolimits_{i = 1}^r (1 + x_i)
\quad\text{and}\quad
c(\mathcal{E}^\vee) = \prod\nolimits_{i = 1}^r (1 - x_i)
$$
in $A^*(X)$. The result follows from a formal computation
which we omit.
\end{proof}

\begin{lemma}
\label{lemma-chern-classes-tensor-product}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{E}$ and $\mathcal{F}$ be a finite locally free
$\mathcal{O}_X$-modules of ranks $r$ and $s$. Then we have
$$
c_1(\mathcal{E} \otimes \mathcal{F})
=
r c_1(\mathcal{F}) + s c_1(\mathcal{E})
$$
$$
c_2(\mathcal{E} \otimes \mathcal{F})
=
r^2 c_2(\mathcal{F}) +
rs c_1(\mathcal{F})c_1(\mathcal{E}) +
s^2 c_2(\mathcal{E})
$$
and so on (see proof).
\end{lemma}

\begin{proof}
Arguing exactly as in the proof of Lemma \ref{lemma-chern-classes-dual}
we may assume we have
invertible $\mathcal{O}_X$-modules
${\mathcal L}_i$, $i = 1, \ldots, r$
${\mathcal N}_i$, $i = 1, \ldots, s$
filtrations
$$
0 = \mathcal{E}_0 \subset \mathcal{E}_1 \subset \mathcal{E}_2
\subset \ldots \subset \mathcal{E}_r = \mathcal{E}
\quad\text{and}\quad
0 = \mathcal{F}_0 \subset \mathcal{F}_1 \subset \mathcal{F}_2
\subset \ldots \subset \mathcal{F}_s = \mathcal{F}
$$
such that $\mathcal{E}_i/\mathcal{E}_{i - 1} \cong \mathcal{L}_i$
and such that $\mathcal{F}_j/\mathcal{F}_{j - 1} \cong \mathcal{N}_j$.
Ordering pairs $(i, j)$ lexicographically
we obtain a filtration
$$
0 \subset \ldots \subset
\mathcal{E}_i \otimes \mathcal{F}_j
+
\mathcal{E}_{i - 1} \otimes \mathcal{F}
\subset \ldots \subset \mathcal{E} \otimes \mathcal{F}
$$
with successive quotients
$$
\mathcal{L}_1 \otimes \mathcal{N}_1,
\mathcal{L}_1 \otimes \mathcal{N}_2,
\ldots,
\mathcal{L}_1 \otimes \mathcal{N}_s,
\mathcal{L}_2 \otimes \mathcal{N}_1,
\ldots,
\mathcal{L}_r \otimes \mathcal{N}_s
$$
By Lemma \ref{lemma-chern-filter-by-linebundles}
we have
$$
c(\mathcal{E}) = \prod (1 + x_i),
\quad
c(\mathcal{F}) = \prod (1 + y_j),
\quad\text{and}\quad
c(\mathcal{F}) = \prod (1 + x_i + y_j),
$$
in $A^*(X)$. The result follows from a formal computation
which we omit.
\end{proof}











\section{Degrees of zero cycles}
\label{section-degree-zero-cycles}

\noindent
This section is the analogue of Chow Homology, Section
\ref{chow-section-degree-zero-cycles}.
We start with defining the degree of a zero cycle on a proper
algebraic space over a field.

\begin{definition}
\label{definition-degree-zero-cycle}
Let $k$ be a field. Let $p : X \to \Spec(k)$ be a proper morphism of
algebraic spaces. The {\it degree of a zero cycle} on $X$ is given by
proper pushforward
$$
p_* : A_0(X) \longrightarrow A_0(\Spec(k)) \longrightarrow \mathbf{Z}
$$
(Lemma \ref{lemma-proper-pushforward-rational-equivalence})
composed with the natural isomorphism $A_0(\Spec(k)) \to \mathbf{Z}$
which maps $[\Spec(k)]$ to $1$. Notation: $\deg(\alpha)$.
\end{definition}

\noindent
Let us spell this out further.

\begin{lemma}
\label{lemma-spell-out-degree-zero-cycle}
Let $k$ be a field. Let $X$ be a proper algebraic space over $k$.
Let $\alpha = \sum n_i[Z_i]$ be in $Z_0(X)$. Then
$$
\deg(\alpha) = \sum n_i\deg(Z_i)
$$
where $\deg(Z_i)$ is the degree of $Z_i \to \Spec(k)$, i.e.,
$\deg(Z_i) = \dim_k \Gamma(Z_i, \mathcal{O}_{Z_i})$.
\end{lemma}

\begin{proof}
This is the definition of proper pushforward
(Definition \ref{definition-proper-pushforward}).
\end{proof}

\begin{lemma}
\label{lemma-degrees-and-numerical-intersections}
Let $k$ be a field. Let $X$ be a proper algebraic space over $k$.
Let $Z \subset X$ be a closed subspace of dimension $d$.
Let $\mathcal{L}_1, \ldots, \mathcal{L}_d$ be invertible
$\mathcal{O}_X$-modules. Then
$$
(\mathcal{L}_1 \cdots \mathcal{L}_d \cdot Z) =
\deg(
c_1(\mathcal{L}_1) \cap \ldots \cap c_1(\mathcal{L}_1) \cap [Z]_d)
$$
where the left hand side is defined in
Spaces over Fields, Definition
\ref{spaces-over-fields-definition-intersection-number}.
\end{lemma}

\begin{proof}
Let $Z_i \subset Z$, $i = 1, \ldots, t$ be the irreducible components
of dimension $d$. Let $m_i$ be the multiplicity of $Z_i$ in $Z$. Then
$[Z]_d = \sum m_i[Z_i]$ and
$c_1(\mathcal{L}_1) \cap \ldots \cap c_1(\mathcal{L}_d) \cap [Z]_d$
is the sum of the cycles
$m_i c_1(\mathcal{L}_1) \cap \ldots \cap c_1(\mathcal{L}_d) \cap [Z_i]$.
Since we have a similar decomposition for
$(\mathcal{L}_1 \cdots \mathcal{L}_d \cdot Z)$ by
Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-numerical-polynomial-leading-term}
it suffices to prove the lemma in case $Z = X$
is a proper integral algebraic space over $k$.

\medskip\noindent
By Chow's lemma there exists a proper morphism $f : X' \to X$
which is an isomorphism over a dense open $U \subset X$
such that $X'$ is a scheme. See More on Morphisms of Spaces, Lemma
\ref{spaces-more-morphisms-lemma-chow-noetherian-separated}.
Then $X'$ is a proper scheme over $k$. After replacing $X'$
by the scheme theoretic closure of $f^{-1}(U)$
we may assume that $X'$ is integral. Then
$$
(f^*\mathcal{L}_1 \cdots f^*\mathcal{L}_d \cdot X') =
(\mathcal{L}_1 \cdots \mathcal{L}_d \cdot X)
$$
by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-intersection-number-and-pullback}
and we have
$$
f_*(c_1(f^*\mathcal{L}_1) \cap \ldots \cap c_1(f^*\mathcal{L}_d) \cap [Y]) =
c_1(\mathcal{L}_1) \cap \ldots \cap c_1(\mathcal{L}_d) \cap [X]
$$
by Lemma \ref{lemma-pushforward-cap-c1}. Thus we may replace $X$ by $X'$
and assume that $X$ is a proper scheme over $k$. This case
was proven in Chow Homology, Lemma
\ref{chow-lemma-degrees-and-numerical-intersections}.
\end{proof}















\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
